

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>chempy package &mdash; chempy 0.6.4 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="chempy 0.6.4 documentation" href="index.html"/>
        <link rel="next" title="chempy.electrochemistry package" href="chempy.electrochemistry.html"/>
        <link rel="prev" title="Welcome to chempy’s documentation!" href="index.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> chempy
          

          
          </a>

          
            
            
              <div class="version">
                0.6.4
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">chempy package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#subpackages">Subpackages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="chempy.electrochemistry.html">chempy.electrochemistry package</a></li>
<li class="toctree-l3"><a class="reference internal" href="chempy.kinetics.html">chempy.kinetics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="chempy.printing.html">chempy.printing package</a></li>
<li class="toctree-l3"><a class="reference internal" href="chempy.properties.html">chempy.properties package</a></li>
<li class="toctree-l3"><a class="reference internal" href="chempy.thermodynamics.html">chempy.thermodynamics package</a></li>
<li class="toctree-l3"><a class="reference internal" href="chempy.util.html">chempy.util package</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.arrhenius">chempy.arrhenius module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.chemistry">chempy.chemistry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.debye_huckel">chempy.debye_huckel module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.einstein_smoluchowski">chempy.einstein_smoluchowski module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.electrolytes">chempy.electrolytes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.equilibria">chempy.equilibria module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.eyring">chempy.eyring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.henry">chempy.henry module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.reactionsystem">chempy.reactionsystem module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.symbolic">chempy.symbolic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-chempy.units">chempy.units module</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">chempy</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>chempy package</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/bjodah/chempy/blob/v0.6.4/doc/chempy.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-chempy">
<span id="chempy-package"></span><h1>chempy package<a class="headerlink" href="#module-chempy" title="Permalink to this headline">¶</a></h1>
<p>ChemPy is a Python package useful for solving problems in chemistry.</p>
<div class="section" id="subpackages">
<h2>Subpackages<a class="headerlink" href="#subpackages" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="chempy.electrochemistry.html">chempy.electrochemistry package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chempy.electrochemistry.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.electrochemistry.html#module-chempy.electrochemistry.nernst">chempy.electrochemistry.nernst module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chempy.kinetics.html">chempy.kinetics package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chempy.kinetics.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.analysis">chempy.kinetics.analysis module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.arrhenius">chempy.kinetics.arrhenius module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.eyring">chempy.kinetics.eyring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.integrated">chempy.kinetics.integrated module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.ode">chempy.kinetics.ode module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.kinetics.html#module-chempy.kinetics.rates">chempy.kinetics.rates module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chempy.printing.html">chempy.printing package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.js">chempy.printing.js module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.numbers">chempy.printing.numbers module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.pretty">chempy.printing.pretty module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.printer">chempy.printing.printer module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.string">chempy.printing.string module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.table">chempy.printing.table module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.tables">chempy.printing.tables module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.tex">chempy.printing.tex module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.printing.html#module-chempy.printing.web">chempy.printing.web module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chempy.properties.html">chempy.properties package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chempy.properties.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.debye_huckel_radii">chempy.properties.debye_huckel_radii module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.sulfuric_acid_density_myhre_1998">chempy.properties.sulfuric_acid_density_myhre_1998 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_density_tanaka_2001">chempy.properties.water_density_tanaka_2001 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_diffusivity_holz_2000">chempy.properties.water_diffusivity_holz_2000 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_permittivity_bradley_pitzer_1979">chempy.properties.water_permittivity_bradley_pitzer_1979 module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.properties.html#module-chempy.properties.water_viscosity_korson_1969">chempy.properties.water_viscosity_korson_1969 module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chempy.thermodynamics.html">chempy.thermodynamics package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chempy.thermodynamics.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.thermodynamics.html#module-chempy.thermodynamics.expressions">chempy.thermodynamics.expressions module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="chempy.util.html">chempy.util package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.arithmeticdict">chempy.util.arithmeticdict module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.bkh">chempy.util.bkh module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.deprecation">chempy.util.deprecation module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.graph">chempy.util.graph module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.numutil">chempy.util.numutil module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.parsing">chempy.util.parsing module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.periodic">chempy.util.periodic module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.pyutil">chempy.util.pyutil module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.regression">chempy.util.regression module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.stoich">chempy.util.stoich module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.table">chempy.util.table module</a></li>
<li class="toctree-l2"><a class="reference internal" href="chempy.util.html#module-chempy.util.testing">chempy.util.testing module</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-chempy.arrhenius">
<span id="chempy-arrhenius-module"></span><h2>chempy.arrhenius module<a class="headerlink" href="#module-chempy.arrhenius" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-chempy.chemistry">
<span id="chempy-chemistry-module"></span><h2>chempy.chemistry module<a class="headerlink" href="#module-chempy.chemistry" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="chempy.chemistry.Equilibrium">
<em class="property">class </em><code class="descclassname">chempy.chemistry.</code><code class="descname">Equilibrium</code><span class="sig-paren">(</span><em>reac</em>, <em>prod</em>, <em>param=None</em>, <em>inact_reac=None</em>, <em>inact_prod=None</em>, <em>name=None</em>, <em>ref=None</em>, <em>data=None</em>, <em>checks=('any_effect'</em>, <em>'all_positive'</em>, <em>'all_integral'</em>, <em>'consistent_units')</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#chempy.chemistry.Reaction" title="chempy.chemistry.Reaction"><code class="xref py py-class docutils literal"><span class="pre">chempy.chemistry.Reaction</span></code></a></p>
<p>Represents an equilibrium reaction</p>
<p>See <a class="reference internal" href="#chempy.chemistry.Reaction" title="chempy.chemistry.Reaction"><code class="xref py py-class docutils literal"><span class="pre">Reaction</span></code></a> for parameters</p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.K" title="chempy.chemistry.Equilibrium.K"><code class="xref py py-obj docutils literal"><span class="pre">K</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>K is deprecated.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.Q" title="chempy.chemistry.Equilibrium.Q"><code class="xref py py-obj docutils literal"><span class="pre">Q</span></code></a>(substances,&nbsp;concs)</td>
<td>Calculates the equilibrium qoutient</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">active_prod_stoich</span></code>(substances)</td>
<td>Per substance product stoichiometry tuple (active)</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">active_reac_stoich</span></code>(substances)</td>
<td>Per substance reactant stoichiometry tuple (active)</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">all_prod_stoich</span></code>(substances)</td>
<td>Per substance product stoichiometry tuple (active &amp; inactive)</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">all_reac_stoich</span></code>(substances)</td>
<td>Per substance reactant stoichiometry tuple (active &amp; inactive)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.as_reactions" title="chempy.chemistry.Equilibrium.as_reactions"><code class="xref py py-obj docutils literal"><span class="pre">as_reactions</span></code></a>([kf,&nbsp;kb,&nbsp;units,&nbsp;variables,&nbsp;…])</td>
<td>Creates a forward and backward <a class="reference internal" href="#chempy.chemistry.Reaction" title="chempy.chemistry.Reaction"><code class="xref py py-class docutils literal"><span class="pre">Reaction</span></code></a> pair</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.cancel" title="chempy.chemistry.Equilibrium.cancel"><code class="xref py py-obj docutils literal"><span class="pre">cancel</span></code></a>(rxn)</td>
<td>Multiplier of how many times rxn can be added/subtracted.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">charge_neutrality_violation</span></code>(substances)</td>
<td>Net amount of charge produced</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">check_all_integral</span></code>()</td>
<td>Checks if all stoichiometric coefficents are integers</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">check_all_positive</span></code>()</td>
<td>Checks if all stoichiometric coefficients are positive</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">check_any_effect</span></code>()</td>
<td>Checks if the reaction has any effect</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.check_consistent_units" title="chempy.chemistry.Equilibrium.check_consistent_units"><code class="xref py py-obj docutils literal"><span class="pre">check_consistent_units</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">composition_violation</span></code>(substances[,&nbsp;…])</td>
<td>Net amount of constituent produced</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.dimensionality" title="chempy.chemistry.Equilibrium.dimensionality"><code class="xref py py-obj docutils literal"><span class="pre">dimensionality</span></code></a>(substances)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.eliminate" title="chempy.chemistry.Equilibrium.eliminate"><code class="xref py py-obj docutils literal"><span class="pre">eliminate</span></code></a>(rxns,&nbsp;wrt)</td>
<td>Linear combination coefficients for elimination of a substance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.equilibrium_constant" title="chempy.chemistry.Equilibrium.equilibrium_constant"><code class="xref py py-obj docutils literal"><span class="pre">equilibrium_constant</span></code></a>([variables,&nbsp;backend])</td>
<td>Return equilibrium constant</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.equilibrium_equation" title="chempy.chemistry.Equilibrium.equilibrium_equation"><code class="xref py py-obj docutils literal"><span class="pre">equilibrium_equation</span></code></a>(variables[,&nbsp;backend])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.equilibrium_expr" title="chempy.chemistry.Equilibrium.equilibrium_expr"><code class="xref py py-obj docutils literal"><span class="pre">equilibrium_expr</span></code></a>()</td>
<td>Turns self.param into a <code class="xref py py-class docutils literal"><span class="pre">EqExpr</span></code> instance (if not already)</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">from_string</span></code>(string[,&nbsp;substance_keys,&nbsp;globals_])</td>
<td>Parses a string into a Reaction instance</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">has_precipitates</span></code>(substances)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">html</span></code>(substances[,&nbsp;with_param])</td>
<td>Returns a HTML representation of the reaction</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">keys</span></code>()</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">latex</span></code>(substances[,&nbsp;with_param])</td>
<td>Returns a LaTeX representation of the reaction</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">mass_balance_violation</span></code>(substances)</td>
<td>Net amount of mass produced</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">net_stoich</span></code>(substance_keys)</td>
<td>Per substance net stoichiometry tuple (active &amp; inactive)</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">non_precipitate_stoich</span></code>(substances)</td>
<td>Only stoichiometry of non-precipitates</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">order</span></code>()</td>
<td>Sum of (active) reactant stoichiometries</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Equilibrium.precipitate_factor" title="chempy.chemistry.Equilibrium.precipitate_factor"><code class="xref py py-obj docutils literal"><span class="pre">precipitate_factor</span></code></a>(substances,&nbsp;sc_concs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">precipitate_stoich</span></code>(substances)</td>
<td>Only stoichiometry of precipitates</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">rate</span></code>([variables,&nbsp;backend,&nbsp;substance_keys,&nbsp;ratex])</td>
<td>Evaluate the rate of a reaction</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">rate_expr</span></code>()</td>
<td>Turns self.param into a RateExpr instance (if not already)</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">string</span></code>([substances,&nbsp;with_param])</td>
<td>Returns a string representation of the reaction</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">unicode</span></code>(substances[,&nbsp;with_param])</td>
<td>Returns a unicode string representation of the reaction</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chempy.chemistry.Equilibrium.K">
<code class="descname">K</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.K"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.K" title="Permalink to this definition">¶</a></dt>
<dd><p>K is deprecated. Use equilibrium_constant instead.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.Q">
<code class="descname">Q</code><span class="sig-paren">(</span><em>substances</em>, <em>concs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.Q"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.Q" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the equilibrium qoutient</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.as_reactions">
<code class="descname">as_reactions</code><span class="sig-paren">(</span><em>kf=None</em>, <em>kb=None</em>, <em>units=None</em>, <em>variables=None</em>, <em>backend=&lt;module 'math' (built-in)&gt;</em>, <em>new_name=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.as_reactions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.as_reactions" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a forward and backward <a class="reference internal" href="#chempy.chemistry.Reaction" title="chempy.chemistry.Reaction"><code class="xref py py-class docutils literal"><span class="pre">Reaction</span></code></a> pair</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>kf</strong> : float or RateExpr</p>
<p><strong>kb</strong> : float or RateExpr</p>
<p><strong>units</strong> : module</p>
<p><strong>variables</strong> : dict, optional</p>
<p class="last"><strong>backend</strong> : module</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.cancel">
<code class="descname">cancel</code><span class="sig-paren">(</span><em>rxn</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.cancel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.cancel" title="Permalink to this definition">¶</a></dt>
<dd><p>Multiplier of how many times rxn can be added/subtracted.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>rxn</strong> : Equilibrium</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;Cd(OH)2(s)&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
<span class="gp">... </span>                 <span class="p">{</span><span class="s1">&#39;Cd4(OH)4+4&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;OH-&#39;</span><span class="p">:</span> <span class="mi">8</span><span class="p">},</span> <span class="mf">7.94e-91</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e2</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;OH-&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">14</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span><span class="o">.</span><span class="n">cancel</span><span class="p">(</span><span class="n">e2</span><span class="p">)</span>
<span class="go">-4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">e1</span> <span class="o">-</span> <span class="mi">4</span><span class="o">*</span><span class="n">e2</span><span class="p">)</span>
<span class="go">4 Cd(OH)2(s) = Cd4(OH)4+4 + 4 OH-; 7.94e-35</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.check_consistent_units">
<code class="descname">check_consistent_units</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.check_consistent_units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.check_consistent_units" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.dimensionality">
<code class="descname">dimensionality</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.dimensionality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.dimensionality" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="staticmethod">
<dt id="chempy.chemistry.Equilibrium.eliminate">
<em class="property">static </em><code class="descname">eliminate</code><span class="sig-paren">(</span><em>rxns</em>, <em>wrt</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.eliminate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.eliminate" title="Permalink to this definition">¶</a></dt>
<dd><p>Linear combination coefficients for elimination of a substance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rxns</strong> : iterable of Equilibrium instances</p>
<p class="last"><strong>wrt</strong> : str (substance key)</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">e1</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;Cd+2&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;Cd4(OH)4+4&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span> <span class="mi">10</span><span class="o">**-</span><span class="mf">32.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">e2</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="p">({</span><span class="s1">&#39;Cd(OH)2(s)&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;Cd+2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;OH-&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="mi">10</span><span class="o">**-</span><span class="mf">14.4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Equilibrium</span><span class="o">.</span><span class="n">eliminate</span><span class="p">([</span><span class="n">e1</span><span class="p">,</span> <span class="n">e2</span><span class="p">],</span> <span class="s1">&#39;Cd+2&#39;</span><span class="p">)</span>
<span class="go">[1, 4]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">e1</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">e2</span><span class="p">)</span>
<span class="go">4 Cd(OH)2(s) + 4 H2O = Cd4(OH)4+4 + 4 H+ + 8 OH-; 7.94e-91</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.equilibrium_constant">
<code class="descname">equilibrium_constant</code><span class="sig-paren">(</span><em>variables=None</em>, <em>backend=&lt;module 'math' (built-in)&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.equilibrium_constant"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.equilibrium_constant" title="Permalink to this definition">¶</a></dt>
<dd><p>Return equilibrium constant</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>variables</strong> : dict, optional</p>
<p class="last"><strong>backend</strong> : module, optional</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.equilibrium_equation">
<code class="descname">equilibrium_equation</code><span class="sig-paren">(</span><em>variables</em>, <em>backend=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.equilibrium_equation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.equilibrium_equation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.equilibrium_expr">
<code class="descname">equilibrium_expr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.equilibrium_expr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.equilibrium_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns self.param into a <code class="xref py py-class docutils literal"><span class="pre">EqExpr</span></code> instance (if not already)</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Equilibrium</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;2 A + B = 3 C; 7&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eqex</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">equilibrium_expr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eqex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="chempy.chemistry.Equilibrium.param_char">
<code class="descname">param_char</code><em class="property"> = 'K'</em><a class="headerlink" href="#chempy.chemistry.Equilibrium.param_char" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Equilibrium.precipitate_factor">
<code class="descname">precipitate_factor</code><span class="sig-paren">(</span><em>substances</em>, <em>sc_concs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Equilibrium.precipitate_factor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Equilibrium.precipitate_factor" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="chempy.chemistry.Reaction">
<em class="property">class </em><code class="descclassname">chempy.chemistry.</code><code class="descname">Reaction</code><span class="sig-paren">(</span><em>reac</em>, <em>prod</em>, <em>param=None</em>, <em>inact_reac=None</em>, <em>inact_prod=None</em>, <em>name=None</em>, <em>ref=None</em>, <em>data=None</em>, <em>checks=('any_effect'</em>, <em>'all_positive'</em>, <em>'all_integral'</em>, <em>'consistent_units')</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class representing a chemical reaction</p>
<p>Consider for example:</p>
<blockquote>
<div>2 R –&gt; A + P; r = k*A*R*R</div></blockquote>
<p>this would be represented as <code class="docutils literal"><span class="pre">Reaction({'A':</span> <span class="pre">1,</span> <span class="pre">'R':</span> <span class="pre">2},</span>
<span class="pre">{'A':</span> <span class="pre">2,</span> <span class="pre">'P':</span> <span class="pre">1},</span> <span class="pre">param=k)</span></code>. Some reactions have a larger
stoichiometric coefficient than what appears in the rate
expression, e.g.:</p>
<blockquote>
<div>5 A + B –&gt; C; r = k*A*B</div></blockquote>
<p>this can be represented as <code class="docutils literal"><span class="pre">Reaction({'C1':</span> <span class="pre">1,</span> <span class="pre">'C2':</span> <span class="pre">1},</span>
<span class="pre">{'B':</span> <span class="pre">1},</span> <span class="pre">inact_reac={'C1':</span> <span class="pre">4},</span> <span class="pre">param=k)</span></code>.</p>
<p>The rate constant information in <code class="docutils literal"><span class="pre">param</span></code> may be a subclass of
<a class="reference internal" href="chempy.kinetics.html#chempy.kinetics.rates.RateExpr" title="chempy.kinetics.rates.RateExpr"><code class="xref py py-class docutils literal"><span class="pre">chempy.kinetics.rates.RateExpr</span></code></a> or carry a <code class="xref py py-meth docutils literal"><span class="pre">as_RateExpr()</span></code>,
if neither: <cite>param</cite> will be assumed to be a rate constant for a mass-action
type of kinetic expression.</p>
<p>Additional data may be stored in the <code class="docutils literal"><span class="pre">data</span></code> dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>reac</strong> : dict (str -&gt; int)</p>
<blockquote>
<div><p>If <code class="docutils literal"><span class="pre">reac</span></code> is a <code class="docutils literal"><span class="pre">set</span></code>, then multiplicities are assumed to be 1.</p>
</div></blockquote>
<p><strong>prod</strong> : dict (str -&gt; int)</p>
<blockquote>
<div><p>If <code class="docutils literal"><span class="pre">prod</span></code> is a <code class="docutils literal"><span class="pre">set</span></code>, then multiplicities are assumed to be 1.</p>
</div></blockquote>
<p><strong>param</strong> : float or callable</p>
<blockquote>
<div><p>Special case (side-effect): if param is a subclass of
<a class="reference internal" href="chempy.kinetics.html#chempy.kinetics.rates.RateExpr" title="chempy.kinetics.rates.RateExpr"><code class="xref py py-class docutils literal"><span class="pre">kinetics.rates.RateExpr</span></code></a> and its <code class="xref py py-attr docutils literal"><span class="pre">rxn</span></code>
is <cite>None</cite> it will be set to <cite>self</cite>.</p>
</div></blockquote>
<p><strong>inact_reac</strong> : dict (optional)</p>
<p><strong>inact_prod</strong> : dict (optional)</p>
<p><strong>name</strong> : str (optional)</p>
<p><strong>k</strong> : deprecated (alias for param)</p>
<p><strong>ref</strong> : object</p>
<blockquote>
<div><p>Reference (e.g. a string containing doi number).</p>
</div></blockquote>
<p><strong>data</strong> : dict (optional)</p>
<p><strong>checks</strong> : iterable of str</p>
<blockquote class="last">
<div><p>Raises <code class="docutils literal"><span class="pre">ValueError</span></code> if any method <code class="docutils literal"><span class="pre">check_%s</span></code> returns False
for all <code class="docutils literal"><span class="pre">%s</span></code> in <code class="docutils literal"><span class="pre">checks</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">({</span><span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">order</span><span class="p">()</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">net_stoich</span><span class="p">([</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">])</span>
<span class="go">(-2, 2, -1)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="go">2 H2 + O2 -&gt; 2 H2O</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="52%" />
<col width="48%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>reac</strong></td>
<td>(OrderedDict)</td>
</tr>
<tr class="row-even"><td><strong>prod</strong></td>
<td>(OrderedDict)</td>
</tr>
<tr class="row-odd"><td><strong>param</strong></td>
<td>(object)</td>
</tr>
<tr class="row-even"><td><strong>inact_reac</strong></td>
<td>(OrderedDict)</td>
</tr>
<tr class="row-odd"><td><strong>inact_prod</strong></td>
<td>(OrderedDict)</td>
</tr>
<tr class="row-even"><td><strong>name</strong></td>
<td>(str)</td>
</tr>
<tr class="row-odd"><td><strong>ref</strong></td>
<td>(str)</td>
</tr>
<tr class="row-even"><td><strong>data</strong></td>
<td>(dict)</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.active_prod_stoich" title="chempy.chemistry.Reaction.active_prod_stoich"><code class="xref py py-obj docutils literal"><span class="pre">active_prod_stoich</span></code></a>(substances)</td>
<td>Per substance product stoichiometry tuple (active)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.active_reac_stoich" title="chempy.chemistry.Reaction.active_reac_stoich"><code class="xref py py-obj docutils literal"><span class="pre">active_reac_stoich</span></code></a>(substances)</td>
<td>Per substance reactant stoichiometry tuple (active)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.all_prod_stoich" title="chempy.chemistry.Reaction.all_prod_stoich"><code class="xref py py-obj docutils literal"><span class="pre">all_prod_stoich</span></code></a>(substances)</td>
<td>Per substance product stoichiometry tuple (active &amp; inactive)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.all_reac_stoich" title="chempy.chemistry.Reaction.all_reac_stoich"><code class="xref py py-obj docutils literal"><span class="pre">all_reac_stoich</span></code></a>(substances)</td>
<td>Per substance reactant stoichiometry tuple (active &amp; inactive)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.charge_neutrality_violation" title="chempy.chemistry.Reaction.charge_neutrality_violation"><code class="xref py py-obj docutils literal"><span class="pre">charge_neutrality_violation</span></code></a>(substances)</td>
<td>Net amount of charge produced</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.check_all_integral" title="chempy.chemistry.Reaction.check_all_integral"><code class="xref py py-obj docutils literal"><span class="pre">check_all_integral</span></code></a>()</td>
<td>Checks if all stoichiometric coefficents are integers</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.check_all_positive" title="chempy.chemistry.Reaction.check_all_positive"><code class="xref py py-obj docutils literal"><span class="pre">check_all_positive</span></code></a>()</td>
<td>Checks if all stoichiometric coefficients are positive</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.check_any_effect" title="chempy.chemistry.Reaction.check_any_effect"><code class="xref py py-obj docutils literal"><span class="pre">check_any_effect</span></code></a>()</td>
<td>Checks if the reaction has any effect</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.check_consistent_units" title="chempy.chemistry.Reaction.check_consistent_units"><code class="xref py py-obj docutils literal"><span class="pre">check_consistent_units</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.composition_violation" title="chempy.chemistry.Reaction.composition_violation"><code class="xref py py-obj docutils literal"><span class="pre">composition_violation</span></code></a>(substances[,&nbsp;…])</td>
<td>Net amount of constituent produced</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.copy" title="chempy.chemistry.Reaction.copy"><code class="xref py py-obj docutils literal"><span class="pre">copy</span></code></a>(**kwargs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.from_string" title="chempy.chemistry.Reaction.from_string"><code class="xref py py-obj docutils literal"><span class="pre">from_string</span></code></a>(string[,&nbsp;substance_keys,&nbsp;globals_])</td>
<td>Parses a string into a Reaction instance</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.has_precipitates" title="chempy.chemistry.Reaction.has_precipitates"><code class="xref py py-obj docutils literal"><span class="pre">has_precipitates</span></code></a>(substances)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.html" title="chempy.chemistry.Reaction.html"><code class="xref py py-obj docutils literal"><span class="pre">html</span></code></a>(substances[,&nbsp;with_param])</td>
<td>Returns a HTML representation of the reaction</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.keys" title="chempy.chemistry.Reaction.keys"><code class="xref py py-obj docutils literal"><span class="pre">keys</span></code></a>()</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.latex" title="chempy.chemistry.Reaction.latex"><code class="xref py py-obj docutils literal"><span class="pre">latex</span></code></a>(substances[,&nbsp;with_param])</td>
<td>Returns a LaTeX representation of the reaction</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.mass_balance_violation" title="chempy.chemistry.Reaction.mass_balance_violation"><code class="xref py py-obj docutils literal"><span class="pre">mass_balance_violation</span></code></a>(substances)</td>
<td>Net amount of mass produced</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.net_stoich" title="chempy.chemistry.Reaction.net_stoich"><code class="xref py py-obj docutils literal"><span class="pre">net_stoich</span></code></a>(substance_keys)</td>
<td>Per substance net stoichiometry tuple (active &amp; inactive)</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.non_precipitate_stoich" title="chempy.chemistry.Reaction.non_precipitate_stoich"><code class="xref py py-obj docutils literal"><span class="pre">non_precipitate_stoich</span></code></a>(substances)</td>
<td>Only stoichiometry of non-precipitates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.order" title="chempy.chemistry.Reaction.order"><code class="xref py py-obj docutils literal"><span class="pre">order</span></code></a>()</td>
<td>Sum of (active) reactant stoichiometries</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.precipitate_stoich" title="chempy.chemistry.Reaction.precipitate_stoich"><code class="xref py py-obj docutils literal"><span class="pre">precipitate_stoich</span></code></a>(substances)</td>
<td>Only stoichiometry of precipitates</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.rate" title="chempy.chemistry.Reaction.rate"><code class="xref py py-obj docutils literal"><span class="pre">rate</span></code></a>([variables,&nbsp;backend,&nbsp;substance_keys,&nbsp;ratex])</td>
<td>Evaluate the rate of a reaction</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.rate_expr" title="chempy.chemistry.Reaction.rate_expr"><code class="xref py py-obj docutils literal"><span class="pre">rate_expr</span></code></a>()</td>
<td>Turns self.param into a RateExpr instance (if not already)</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Reaction.string" title="chempy.chemistry.Reaction.string"><code class="xref py py-obj docutils literal"><span class="pre">string</span></code></a>([substances,&nbsp;with_param])</td>
<td>Returns a string representation of the reaction</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Reaction.unicode" title="chempy.chemistry.Reaction.unicode"><code class="xref py py-obj docutils literal"><span class="pre">unicode</span></code></a>(substances[,&nbsp;with_param])</td>
<td>Returns a unicode string representation of the reaction</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chempy.chemistry.Reaction.active_prod_stoich">
<code class="descname">active_prod_stoich</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.active_prod_stoich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.active_prod_stoich" title="Permalink to this definition">¶</a></dt>
<dd><p>Per substance product stoichiometry tuple (active)</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.active_reac_stoich">
<code class="descname">active_reac_stoich</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.active_reac_stoich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.active_reac_stoich" title="Permalink to this definition">¶</a></dt>
<dd><p>Per substance reactant stoichiometry tuple (active)</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.all_prod_stoich">
<code class="descname">all_prod_stoich</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.all_prod_stoich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.all_prod_stoich" title="Permalink to this definition">¶</a></dt>
<dd><p>Per substance product stoichiometry tuple (active &amp; inactive)</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.all_reac_stoich">
<code class="descname">all_reac_stoich</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.all_reac_stoich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.all_reac_stoich" title="Permalink to this definition">¶</a></dt>
<dd><p>Per substance reactant stoichiometry tuple (active &amp; inactive)</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.charge_neutrality_violation">
<code class="descname">charge_neutrality_violation</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.charge_neutrality_violation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.charge_neutrality_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Net amount of charge produced</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>substances: dict</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">float: amount of net charge produced/consumed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.check_all_integral">
<code class="descname">check_all_integral</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.check_all_integral"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.check_all_integral" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if all stoichiometric coefficents are integers</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.check_all_positive">
<code class="descname">check_all_positive</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.check_all_positive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.check_all_positive" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if all stoichiometric coefficients are positive</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.check_any_effect">
<code class="descname">check_any_effect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.check_any_effect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.check_any_effect" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the reaction has any effect</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.check_consistent_units">
<code class="descname">check_consistent_units</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.check_consistent_units"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.check_consistent_units" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.composition_violation">
<code class="descname">composition_violation</code><span class="sig-paren">(</span><em>substances</em>, <em>composition_keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.composition_violation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.composition_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Net amount of constituent produced</p>
<p>If composition keys correspond to conserved entities e.g. atoms
in chemical reactions, this function should return a list of zeros.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>substances</strong> : dict</p>
<p><strong>composition_keys</strong> : iterable of str, <code class="docutils literal"><span class="pre">None</span></code> or <code class="docutils literal"><span class="pre">True</span></code></p>
<blockquote>
<div><p>When <code class="docutils literal"><span class="pre">None</span></code> or True: composition keys are taken from substances.
When <code class="docutils literal"><span class="pre">True</span></code> the keys are also return as an extra return value</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="first last simple">
<li>If <code class="docutils literal"><span class="pre">composition_keys</span> <span class="pre">==</span> <span class="pre">True</span></code>: a tuple: (violations, composition_keys)</li>
<li>Otherwise: violations (list of coefficients)</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.copy">
<code class="descname">copy</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.copy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.copy" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="classmethod">
<dt id="chempy.chemistry.Reaction.from_string">
<em class="property">classmethod </em><code class="descname">from_string</code><span class="sig-paren">(</span><em>string</em>, <em>substance_keys=None</em>, <em>globals_=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Parses a string into a Reaction instance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>string</strong> : str</p>
<blockquote>
<div><p>String representation of the reaction.</p>
</div></blockquote>
<p><strong>substance_keys</strong> : convertible to iterable of strings or string or None</p>
<blockquote>
<div><p>Used prevent e.g. misspelling.
if str: split is invoked, if None: no checking done.</p>
</div></blockquote>
<p><strong>globals_</strong> : dict (optional)</p>
<blockquote>
<div><p>Dictionary for eval for (default: None -&gt; {‘chempy’: chempy})
If <code class="docutils literal"><span class="pre">False</span></code>: no eval will be called (useful for web-apps).</p>
</div></blockquote>
<p><strong>**kwargs :</strong></p>
<blockquote class="last">
<div><p>Passed on to constructor.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p><a class="reference internal" href="chempy.util.html#chempy.util.parsing.to_reaction" title="chempy.util.parsing.to_reaction"><code class="xref py py-func docutils literal"><span class="pre">chempy.util.parsing.to_reaction()</span></code></a> is used which in turn calls
<code class="xref py py-func docutils literal"><span class="pre">eval()</span></code> which is a severe security concern for untrusted input.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H2O -&gt; H+ + OH-; 1e-4&quot;</span><span class="p">,</span> <span class="s1">&#39;H2O H+ OH-&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">reac</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span> <span class="ow">and</span> <span class="n">r</span><span class="o">.</span><span class="n">prod</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;OH-&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;2 H2O -&gt; 2 H2 + O2&quot;</span><span class="p">,</span> <span class="s1">&#39;H2O H2 O2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="o">.</span><span class="n">reac</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span> <span class="ow">and</span> <span class="n">r2</span><span class="o">.</span><span class="n">prod</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r3</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;A -&gt; B; 1/second&quot;</span><span class="p">,</span> <span class="s1">&#39;A B&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.units</span> <span class="k">import</span> <span class="n">to_unitless</span><span class="p">,</span> <span class="n">default_units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">to_unitless</span><span class="p">(</span><span class="n">r3</span><span class="o">.</span><span class="n">param</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">hour</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span>
<span class="go">3600.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r4</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;A -&gt; B; &#39;k&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;A B&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r4</span><span class="o">.</span><span class="n">param</span><span class="o">.</span><span class="n">unique_keys</span>
<span class="go">(&#39;k&#39;,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r5</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;A -&gt; B; 1/molar/second&quot;</span><span class="p">,</span> <span class="s1">&#39;A B&#39;</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Check failed: &#39;consistent_units&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.has_precipitates">
<code class="descname">has_precipitates</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.has_precipitates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.has_precipitates" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.html">
<code class="descname">html</code><span class="sig-paren">(</span><em>substances</em>, <em>with_param=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.html"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.html" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a HTML representation of the reaction</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="s1">&#39;H2O H+ OH-&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subst</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H2O -&gt; H+ + OH-; 1e-4&quot;</span><span class="p">,</span> <span class="n">subst</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">html</span><span class="p">(</span><span class="n">subst</span><span class="p">)</span>
<span class="go">&#39;H&lt;sub&gt;2&lt;/sub&gt;O &amp;rarr; H&lt;sup&gt;+&lt;/sup&gt; + OH&lt;sup&gt;-&lt;/sup&gt;&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H+ + OH- -&gt; H2O; 1e8/molar/second&quot;</span><span class="p">,</span> <span class="n">subst</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="o">.</span><span class="n">html</span><span class="p">(</span><span class="n">subst</span><span class="p">,</span> <span class="n">with_param</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="go">&#39;H&lt;sup&gt;+&lt;/sup&gt; + OH&lt;sup&gt;-&lt;/sup&gt; &amp;rarr; H&lt;sub&gt;2&lt;/sub&gt;O&amp;#59; 10&lt;sup&gt;8&lt;/sup&gt; 1/(s*M)&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.keys">
<code class="descname">keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.latex">
<code class="descname">latex</code><span class="sig-paren">(</span><em>substances</em>, <em>with_param=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.latex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.latex" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a LaTeX representation of the reaction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>substances: dict</strong></p>
<blockquote>
<div><p>mapping substance keys to Substance instances</p>
</div></blockquote>
<p><strong>with_param: bool</strong></p>
<blockquote class="last">
<div><p>whether to print the parameter (default: False)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="s1">&#39;H2O H+ OH-&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subst</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H2O -&gt; H+ + OH-; 1e-4&quot;</span><span class="p">,</span> <span class="n">subst</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">subst</span><span class="p">)</span> <span class="o">==</span> <span class="sa">r</span><span class="s1">&#39;H_</span><span class="si">{2}</span><span class="s1">O \rightarrow H^{+} + OH^{-}&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H+ + OH- -&gt; H2O; 1e8/molar/second&quot;</span><span class="p">,</span> <span class="n">subst</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;H^{+} + OH^{-} \rightarrow H_</span><span class="si">{2}</span><span class="s1">O; 10^</span><span class="si">{8}</span><span class="s1"> $\mathrm{\frac</span><span class="si">{1}</span><span class="s1">{(s{\cdot}M)}}$&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="o">.</span><span class="n">latex</span><span class="p">(</span><span class="n">subst</span><span class="p">,</span> <span class="n">with_param</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="n">ref</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.mass_balance_violation">
<code class="descname">mass_balance_violation</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.mass_balance_violation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.mass_balance_violation" title="Permalink to this definition">¶</a></dt>
<dd><p>Net amount of mass produced</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>substances: dict</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">float: amount of net mass produced/consumed</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.net_stoich">
<code class="descname">net_stoich</code><span class="sig-paren">(</span><em>substance_keys</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.net_stoich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.net_stoich" title="Permalink to this definition">¶</a></dt>
<dd><p>Per substance net stoichiometry tuple (active &amp; inactive)</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.non_precipitate_stoich">
<code class="descname">non_precipitate_stoich</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.non_precipitate_stoich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.non_precipitate_stoich" title="Permalink to this definition">¶</a></dt>
<dd><p>Only stoichiometry of non-precipitates</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.order">
<code class="descname">order</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.order"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.order" title="Permalink to this definition">¶</a></dt>
<dd><p>Sum of (active) reactant stoichiometries</p>
</dd></dl>

<dl class="attribute">
<dt id="chempy.chemistry.Reaction.param_char">
<code class="descname">param_char</code><em class="property"> = 'k'</em><a class="headerlink" href="#chempy.chemistry.Reaction.param_char" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.precipitate_stoich">
<code class="descname">precipitate_stoich</code><span class="sig-paren">(</span><em>substances</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.precipitate_stoich"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.precipitate_stoich" title="Permalink to this definition">¶</a></dt>
<dd><p>Only stoichiometry of precipitates</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.rate">
<code class="descname">rate</code><span class="sig-paren">(</span><em>variables=None</em>, <em>backend=&lt;module 'math' (built-in)&gt;</em>, <em>substance_keys=None</em>, <em>ratex=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.rate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.rate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate the rate of a reaction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>variables</strong> : dict</p>
<p><strong>backend</strong> : module, optional</p>
<p><strong>substance_keys</strong> : iterable of str, optional</p>
<p><strong>ratex</strong> : RateExpr</p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Dictionary mapping substance keys to the reactions contribution to overall rates.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rxn1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;2 H2 + O2 -&gt; 2 H2O; 3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref1</span> <span class="o">=</span> <span class="mi">3</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rxn1</span><span class="o">.</span><span class="n">rate</span><span class="p">({</span><span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">ref1</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="o">-</span><span class="n">ref1</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="o">*</span><span class="n">ref1</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy</span> <span class="k">import</span> <span class="n">Symbol</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">k</span> <span class="o">=</span> <span class="n">Symbol</span><span class="p">(</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rxn2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">(</span><span class="n">rxn1</span><span class="o">.</span><span class="n">reac</span><span class="p">,</span> <span class="n">rxn1</span><span class="o">.</span><span class="n">prod</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">concentrations</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="p">:</span> <span class="n">Symbol</span><span class="p">(</span><span class="n">key</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">rxn1</span><span class="o">.</span><span class="n">reac</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="n">rxn1</span><span class="o">.</span><span class="n">prod</span><span class="p">))}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pprint</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">pprint</span><span class="o">.</span><span class="n">pprint</span><span class="p">(</span><span class="n">rxn2</span><span class="o">.</span><span class="n">rate</span><span class="p">(</span><span class="n">concentrations</span><span class="p">))</span>
<span class="go">{&#39;H2&#39;: -2*H2**2*O2*k, &#39;H2O&#39;: 2*H2**2*O2*k, &#39;O2&#39;: -H2**2*O2*k}</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.rate_expr">
<code class="descname">rate_expr</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.rate_expr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.rate_expr" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns self.param into a RateExpr instance (if not already)</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;2 A + B -&gt; 3 C; 7&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratex</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">rate_expr</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ratex</span><span class="o">.</span><span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">7</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.string">
<code class="descname">string</code><span class="sig-paren">(</span><em>substances=None</em>, <em>with_param=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.string" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string representation of the reaction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>substances: dict</strong></p>
<blockquote>
<div><p>mapping substance keys to Substance instances</p>
</div></blockquote>
<p><strong>with_param: bool</strong></p>
<blockquote class="last">
<div><p>whether to print the parameter (default: False)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">({</span><span class="s1">&#39;H+&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Cl-&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;HCl&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mf">1e10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">string</span><span class="p">(</span><span class="n">with_param</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="go">&#39;Cl- + H+ -&gt; HCl&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Reaction.unicode">
<code class="descname">unicode</code><span class="sig-paren">(</span><em>substances</em>, <em>with_param=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Reaction.unicode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Reaction.unicode" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a unicode string representation of the reaction</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">keys</span> <span class="o">=</span> <span class="s1">&#39;H2O H+ OH-&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">subst</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H2O -&gt; H+ + OH-; 1e-4&quot;</span><span class="p">,</span> <span class="n">subst</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="o">.</span><span class="n">unicode</span><span class="p">(</span><span class="n">subst</span><span class="p">)</span> <span class="o">==</span> <span class="sa">u</span><span class="s1">&#39;H₂O → H⁺ + OH⁻&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span> <span class="o">=</span> <span class="n">Reaction</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s2">&quot;H+ + OH- -&gt; H2O; 1e8/molar/second&quot;</span><span class="p">,</span> <span class="n">subst</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r2</span><span class="o">.</span><span class="n">unicode</span><span class="p">(</span><span class="n">subst</span><span class="p">,</span> <span class="n">with_param</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="o">==</span> <span class="sa">u</span><span class="s1">&#39;H⁺ + OH⁻ → H₂O; 10⁸ 1/(s·M)&#39;</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chempy.chemistry.Solute">
<em class="property">class </em><code class="descclassname">chempy.chemistry.</code><code class="descname">Solute</code><span class="sig-paren">(</span><em>_self</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Solute"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Solute" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#chempy.chemistry.Solute" title="chempy.chemistry.Solute"><code class="xref py py-class docutils literal"><span class="pre">chempy.chemistry.Solute</span></code></a></p>
<p>Solute is deprecated since (not including) 0.3.0, it will be missing in 0.7.0. Use Species instead.</p>
<p>[DEPRECATED] Use <cite>.Species</cite> instead</p>
<blockquote>
<div>Counter-intuitive to its name Solute has an additional
property ‘precipitate’</div></blockquote>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">charge</span></code></td>
<td>Convenience property for accessing <code class="docutils literal"><span class="pre">composition[0]</span></code></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">mass</span></code></td>
<td>Convenience property for accessing <code class="docutils literal"><span class="pre">data['mass']</span></code></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">composition_keys</span></code>(substance_iter[,&nbsp;skip_keys])</td>
<td>Occuring <code class="xref py py-attr docutils literal"><span class="pre">composition</span></code> keys among a series of substances</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">from_formula</span></code>(formula,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">molar_mass</span></code>([units])</td>
<td>Returns the molar mass (with units) of the substance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="chempy.chemistry.Species">
<em class="property">class </em><code class="descclassname">chempy.chemistry.</code><code class="descname">Species</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Species"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Species" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#chempy.chemistry.Substance" title="chempy.chemistry.Substance"><code class="xref py py-class docutils literal"><span class="pre">chempy.chemistry.Substance</span></code></a></p>
<p>Substance belonging to a phase</p>
<p>Species extends <a class="reference internal" href="#chempy.chemistry.Substance" title="chempy.chemistry.Substance"><code class="xref py py-class docutils literal"><span class="pre">Substance</span></code></a> with the new attribute <code class="xref py py-attr docutils literal"><span class="pre">phase_idx</span></code></p>
<p class="rubric">Attributes</p>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>phase_idx: int</strong></td>
<td>Index of the phase (default is 0)</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">composition_keys</span></code>(substance_iter[,&nbsp;skip_keys])</td>
<td>Occuring <code class="xref py py-attr docutils literal"><span class="pre">composition</span></code> keys among a series of substances</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Species.from_formula" title="chempy.chemistry.Species.from_formula"><code class="xref py py-obj docutils literal"><span class="pre">from_formula</span></code></a>(formula[,&nbsp;phases,&nbsp;…])</td>
<td>Create a <a class="reference internal" href="#chempy.chemistry.Species" title="chempy.chemistry.Species"><code class="xref py py-class docutils literal"><span class="pre">Species</span></code></a> instance from its formula</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">molar_mass</span></code>([units])</td>
<td>Returns the molar mass (with units) of the substance</td>
</tr>
</tbody>
</table>
<dl class="classmethod">
<dt id="chempy.chemistry.Species.from_formula">
<em class="property">classmethod </em><code class="descname">from_formula</code><span class="sig-paren">(</span><em>formula</em>, <em>phases=('(s)'</em>, <em>'(l)'</em>, <em>'(g)')</em>, <em>default_phase_idx=0</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Species.from_formula"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Species.from_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a <a class="reference internal" href="#chempy.chemistry.Species" title="chempy.chemistry.Species"><code class="xref py py-class docutils literal"><span class="pre">Species</span></code></a> instance from its formula</p>
<p>Analogous to <a class="reference internal" href="#chempy.chemistry.Substance.from_formula" title="chempy.chemistry.Substance.from_formula"><code class="xref py py-meth docutils literal"><span class="pre">Substance.from_formula()</span></code></a> but with the addition that
phase_idx is determined from the formula (and a mapping provided by
<code class="docutils literal"><span class="pre">phases</span></code>)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>formula: str</strong></p>
<blockquote>
<div><p>e.g. ‘H2O’, ‘NaCl(s)’, ‘CO2(aq)’, ‘CO2(g)’</p>
</div></blockquote>
<p><strong>phases: iterable of str or dict mapping str -&gt; int</strong></p>
<blockquote>
<div><p>if not in **kwargs, <code class="docutils literal"><span class="pre">phase_idx</span></code> is determined from the suffix
of <code class="docutils literal"><span class="pre">formula</span></code> where the suffixes is mapped from phases:</p>
<blockquote>
<div><dl class="docutils">
<dt>if <code class="docutils literal"><span class="pre">phases</span></code> is a dictionary:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">phase_idx</span> <span class="pre">=</span> <span class="pre">phases[suffix]</span></code></p>
</dd>
<dt>else:</dt>
<dd><p class="first last"><code class="docutils literal"><span class="pre">phase_idx</span> <span class="pre">=</span> <span class="pre">phases.index(suffix)</span> <span class="pre">+</span> <span class="pre">1</span></code></p>
</dd>
</dl>
</div></blockquote>
<p>and if suffixes is missing in phases phase_idx is taken to be 0</p>
</div></blockquote>
<p><strong>default_phase_idx: int or None (default: 0)</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>If <code class="docutils literal"><span class="pre">default_phase_idx</span></code> is <code class="docutils literal"><span class="pre">None</span></code>, <code class="docutils literal"><span class="pre">ValueError</span></code> is raised for</dt>
<dd><p class="first last">unkown suffixes.</p>
</dd>
</dl>
<p>Else <code class="docutils literal"><span class="pre">default_phase_idx</span></code> is used as <code class="docutils literal"><span class="pre">phase_idx</span></code> in those cases.</p>
</div></blockquote>
<p><strong>**kwargs:</strong></p>
<blockquote>
<div><p>Keyword arguments passed on.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError:</strong></p>
<blockquote class="last">
<div><p>if <code class="docutils literal"><span class="pre">default_phase_idx</span></code> is <code class="docutils literal"><span class="pre">None</span></code> and no suffix found in phases</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">water</span> <span class="o">=</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;H2O&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">water</span><span class="o">.</span><span class="n">phase_idx</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NaCl</span> <span class="o">=</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;NaCl(s)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NaCl</span><span class="o">.</span><span class="n">phase_idx</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hg_l</span> <span class="o">=</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;Hg(l)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Hg_l</span><span class="o">.</span><span class="n">phase_idx</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CO2g</span> <span class="o">=</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;CO2(g)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CO2g</span><span class="o">.</span><span class="n">phase_idx</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CO2aq</span> <span class="o">=</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;CO2(aq)&#39;</span><span class="p">,</span> <span class="n">default_phase_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Could not determine phase_idx</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CO2aq</span> <span class="o">=</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;CO2(aq)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CO2aq</span><span class="o">.</span><span class="n">phase_idx</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CO2aq</span> <span class="o">=</span> <span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;CO2(aq)&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;(aq)&#39;</span><span class="p">],</span>
<span class="gp">... </span>    <span class="n">default_phase_idx</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">CO2aq</span><span class="o">.</span><span class="n">phase_idx</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Species</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;CO2(aq)&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;(aq)&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">},</span> <span class="kc">None</span><span class="p">)</span><span class="o">.</span><span class="n">phase_idx</span>
<span class="go">0</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="chempy.chemistry.Species.precipitate">
<code class="descname">precipitate</code><a class="headerlink" href="#chempy.chemistry.Species.precipitate" title="Permalink to this definition">¶</a></dt>
<dd><p>precipitate is deprecated since (not including) 0.3.0, it will be missing in 0.5.0.</p>
<p>deprecated attribute, provided for compatibility for now</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chempy.chemistry.Substance">
<em class="property">class </em><code class="descclassname">chempy.chemistry.</code><code class="descname">Substance</code><span class="sig-paren">(</span><em>name=None</em>, <em>charge=None</em>, <em>latex_name=None</em>, <em>unicode_name=None</em>, <em>html_name=None</em>, <em>composition=None</em>, <em>data=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Substance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Substance" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Class representing a chemical substance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>name</strong> : str</p>
<p><strong>charge</strong> : int (optional, default: None)</p>
<blockquote>
<div><p>Will be stored in composition[0], prefer composition when possible.</p>
</div></blockquote>
<p><strong>latex_name</strong> : str</p>
<p><strong>unicode_name</strong> : str</p>
<p><strong>html_name</strong> : str</p>
<p><strong>composition</strong> : dict or None (default)</p>
<blockquote>
<div><p>Dictionary (int -&gt; number) e.g. {atomic number: count}, zero has special
meaning (net charge). Avoid using the key 0 unless you specifically mean
net charge. The motivation behind this is that it is easier to track a
net-charge of e.g. 6 for U(VI) than it is to remember that uranium has 92
electrons and use 86 as the value).</p>
</div></blockquote>
<p><strong>data</strong> : dict</p>
<blockquote class="last">
<div><p>Free form dictionary. Could be simple such as <code class="docutils literal"><span class="pre">{'mp':</span> <span class="pre">0,</span> <span class="pre">'bp':</span> <span class="pre">100}</span></code>
or considerably more involved, e.g.: <code class="docutils literal"><span class="pre">{'diffusion_coefficient':</span> <span class="pre">{</span> <span class="pre">'water':</span> <span class="pre">lambda</span> <span class="pre">T:</span> <span class="pre">2.1*m**2/s/K*(T</span> <span class="pre">-</span> <span class="pre">273.15*K)}}</span></code>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ammonium</span> <span class="o">=</span> <span class="n">Substance</span><span class="p">(</span><span class="s1">&#39;NH4+&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;NH_4^+&#39;</span><span class="p">,</span> <span class="n">composition</span><span class="o">=</span><span class="p">{</span><span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">},</span>
<span class="gp">... </span>    <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;mass&#39;</span><span class="p">:</span> <span class="mf">18.0385</span><span class="p">,</span> <span class="s1">&#39;pKa&#39;</span><span class="p">:</span> <span class="mf">9.24</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ammonium</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;NH4+&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ammonium</span><span class="o">.</span><span class="n">composition</span> <span class="o">==</span> <span class="p">{</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>  <span class="c1"># charge represented by key &#39;0&#39;</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ammonium</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mass&#39;</span><span class="p">]</span>
<span class="go">18.0385</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ammonium</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;pKa&#39;</span><span class="p">]</span>
<span class="go">9.24</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ammonium</span><span class="o">.</span><span class="n">mass</span>  <span class="c1"># mass is a special case (also attribute)</span>
<span class="go">18.0385</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ammonium</span><span class="o">.</span><span class="n">pKa</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">AttributeError</span>: <span class="n">&#39;Substance&#39; object has no attribute &#39;pKa&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nh4p</span> <span class="o">=</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;NH4+&#39;</span><span class="p">)</span>  <span class="c1"># simpler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nh4p</span><span class="o">.</span><span class="n">composition</span> <span class="o">==</span> <span class="p">{</span><span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nh4p</span><span class="o">.</span><span class="n">latex_name</span>
<span class="go">&#39;NH_{4}^{+}&#39;</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Substance.mass" title="chempy.chemistry.Substance.mass"><code class="xref py py-obj docutils literal"><span class="pre">mass</span></code></a></td>
<td>Convenience property for accessing <code class="docutils literal"><span class="pre">data['mass']</span></code></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="82%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>attrs</strong></td>
<td>A tuple of attribute names for serialization.</td>
</tr>
<tr class="row-even"><td><strong>composition</strong></td>
<td>(dict or None) Dictionary mapping fragment key (str) to amount (int).</td>
</tr>
<tr class="row-odd"><td><strong>data</strong></td>
<td>Free form dictionary.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Substance.composition_keys" title="chempy.chemistry.Substance.composition_keys"><code class="xref py py-obj docutils literal"><span class="pre">composition_keys</span></code></a>(substance_iter[,&nbsp;skip_keys])</td>
<td>Occuring <code class="xref py py-attr docutils literal"><span class="pre">composition</span></code> keys among a series of substances</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.chemistry.Substance.from_formula" title="chempy.chemistry.Substance.from_formula"><code class="xref py py-obj docutils literal"><span class="pre">from_formula</span></code></a>(formula,&nbsp;**kwargs)</td>
<td>Creates a <a class="reference internal" href="#chempy.chemistry.Substance" title="chempy.chemistry.Substance"><code class="xref py py-class docutils literal"><span class="pre">Substance</span></code></a> instance from its formula</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.chemistry.Substance.molar_mass" title="chempy.chemistry.Substance.molar_mass"><code class="xref py py-obj docutils literal"><span class="pre">molar_mass</span></code></a>([units])</td>
<td>Returns the molar mass (with units) of the substance</td>
</tr>
</tbody>
</table>
<dl class="attribute">
<dt id="chempy.chemistry.Substance.attrs">
<code class="descname">attrs</code><em class="property"> = ('name', 'latex_name', 'unicode_name', 'html_name', 'composition', 'data')</em><a class="headerlink" href="#chempy.chemistry.Substance.attrs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="chempy.chemistry.Substance.charge">
<code class="descname">charge</code><a class="headerlink" href="#chempy.chemistry.Substance.charge" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property for accessing <code class="docutils literal"><span class="pre">composition[0]</span></code></p>
</dd></dl>

<dl class="staticmethod">
<dt id="chempy.chemistry.Substance.composition_keys">
<em class="property">static </em><code class="descname">composition_keys</code><span class="sig-paren">(</span><em>substance_iter</em>, <em>skip_keys=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Substance.composition_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Substance.composition_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Occuring <code class="xref py py-attr docutils literal"><span class="pre">composition</span></code> keys among a series of substances</p>
</dd></dl>

<dl class="classmethod">
<dt id="chempy.chemistry.Substance.from_formula">
<em class="property">classmethod </em><code class="descname">from_formula</code><span class="sig-paren">(</span><em>formula</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Substance.from_formula"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Substance.from_formula" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a <a class="reference internal" href="#chempy.chemistry.Substance" title="chempy.chemistry.Substance"><code class="xref py py-class docutils literal"><span class="pre">Substance</span></code></a> instance from its formula</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>formula: str</strong></p>
<blockquote>
<div><p>e.g. ‘Na+’, ‘H2O’, ‘Fe(CN)6-4’</p>
</div></blockquote>
<p><strong>**kwargs:</strong></p>
<blockquote class="last">
<div><p>keyword arguments passed on to <cite>.Substance</cite></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">NH3</span> <span class="o">=</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;NH3&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NH3</span><span class="o">.</span><span class="n">composition</span> <span class="o">==</span> <span class="p">{</span><span class="mi">1</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;</span><span class="si">%.2f</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">NH3</span><span class="o">.</span><span class="n">mass</span>
<span class="go">&#39;17.03&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NH3</span><span class="o">.</span><span class="n">charge</span>
<span class="go">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">NH3</span><span class="o">.</span><span class="n">latex_name</span>
<span class="go">&#39;NH_{3}&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="chempy.chemistry.Substance.mass">
<code class="descname">mass</code><a class="headerlink" href="#chempy.chemistry.Substance.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience property for accessing <code class="docutils literal"><span class="pre">data['mass']</span></code></p>
<p>when <code class="docutils literal"><span class="pre">data['mass']</span></code> is missing the mass is calculated
from the <code class="xref py py-attr docutils literal"><span class="pre">composition</span></code> using
<code class="xref py py-func docutils literal"><span class="pre">chempy.util.parsing.mass_from_composition()</span></code>.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.chemistry.Substance.molar_mass">
<code class="descname">molar_mass</code><span class="sig-paren">(</span><em>units=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#Substance.molar_mass"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.Substance.molar_mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the molar mass (with units) of the substance</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">nh4p</span> <span class="o">=</span> <span class="n">Substance</span><span class="o">.</span><span class="n">from_formula</span><span class="p">(</span><span class="s1">&#39;NH4+&#39;</span><span class="p">)</span>  <span class="c1"># simpler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.units</span> <span class="k">import</span> <span class="n">default_units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nh4p</span><span class="o">.</span><span class="n">molar_mass</span><span class="p">(</span><span class="n">u</span><span class="p">)</span>
<span class="go">array(18.0384511...) * g/mol</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="chempy.chemistry.balance_stoichiometry">
<code class="descclassname">chempy.chemistry.</code><code class="descname">balance_stoichiometry</code><span class="sig-paren">(</span><em>reactants</em>, <em>products</em>, <em>substances=None</em>, <em>substance_factory=&lt;bound method type.from_formula of &lt;class 'chempy.chemistry.Substance'&gt;&gt;</em>, <em>parametric_symbols=None</em>, <em>underdetermined=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#balance_stoichiometry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.balance_stoichiometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Balances stoichiometric coefficients of a reaction</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>reactants</strong> : iterable of reactant keys</p>
<p><strong>products</strong> : iterable of product keys</p>
<p><strong>substances</strong> : OrderedDict or string or None</p>
<blockquote>
<div><p>Mapping reactant/product keys to instances of <a class="reference internal" href="#chempy.chemistry.Substance" title="chempy.chemistry.Substance"><code class="xref py py-class docutils literal"><span class="pre">Substance</span></code></a>.</p>
</div></blockquote>
<p><strong>substance_factory</strong> : callback</p>
<p><strong>parametric_symbols</strong> : generator of symbols</p>
<blockquote>
<div><p>Used to generate symbols for parametric solution for
under-determined system of equations. Default is numbered “x-symbols” starting
from 1.</p>
</div></blockquote>
<p><strong>underdetermined</strong> : bool</p>
<blockquote>
<div><p>Allows to find a non-unique solution (in addition to a constant factor
across all terms). Set to <code class="docutils literal"><span class="pre">False</span></code> to disallow (raise ValueError) on
e.g. “C + O2 -&gt; CO + CO2”. Set to <code class="docutils literal"><span class="pre">None</span></code> if you want the symbols replaced
so that the coefficients are the smallest possible positive (non-zero) integers.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>balanced reactants</strong> : dict</p>
<p class="last"><strong>balanced products</strong> : dict</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;C2H2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;CO&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;C2H2&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;CO&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">})</span> <span class="o">==</span> <span class="n">ref</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref2</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;H2O2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">balance_stoichiometry</span><span class="p">(</span><span class="s1">&#39;H2 O2&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="p">[</span><span class="s1">&#39;H2O2&#39;</span><span class="p">],</span> <span class="s1">&#39;H2 O2 H2O2&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">ref2</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reac</span><span class="p">,</span> <span class="n">prod</span> <span class="o">=</span> <span class="s1">&#39;CuSCN KIO3 HCl&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">(),</span> <span class="s1">&#39;CuSO4 KCl HCN ICl H2O&#39;</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Reaction</span><span class="p">(</span><span class="o">*</span><span class="n">balance_stoichiometry</span><span class="p">(</span><span class="n">reac</span><span class="p">,</span> <span class="n">prod</span><span class="p">))</span><span class="o">.</span><span class="n">string</span><span class="p">()</span>
<span class="go">&#39;4 CuSCN + 7 KIO3 + 14 HCl -&gt; 4 CuSO4 + 7 KCl + 4 HCN + 7 ICl + 5 H2O&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;FeO&#39;</span><span class="p">,</span> <span class="s1">&#39;Fe2O3&#39;</span><span class="p">},</span> <span class="n">underdetermined</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">The system was under-determined</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r</span><span class="p">,</span> <span class="n">p</span> <span class="o">=</span> <span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;FeO&#39;</span><span class="p">,</span> <span class="s1">&#39;Fe2O3&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="nb">set</span><span class="o">.</span><span class="n">union</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">free_symbols</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">r</span><span class="o">.</span><span class="n">values</span><span class="p">()]))</span>
<span class="go">[x1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">balance_stoichiometry</span><span class="p">({</span><span class="s1">&#39;Fe&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;FeO&#39;</span><span class="p">,</span> <span class="s1">&#39;Fe2O3&#39;</span><span class="p">},</span> <span class="n">underdetermined</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">==</span> <span class="p">({</span><span class="s1">&#39;Fe&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;FeO&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;Fe2O3&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.chemistry.equilibrium_quotient">
<code class="descclassname">chempy.chemistry.</code><code class="descname">equilibrium_quotient</code><span class="sig-paren">(</span><em>concs</em>, <em>stoich</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#equilibrium_quotient"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.equilibrium_quotient" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the equilibrium quotient of an equilbrium</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>concs: array_like</strong></p>
<blockquote>
<div><p>per substance concentration</p>
</div></blockquote>
<p><strong>stoich: iterable of integers</strong></p>
<blockquote class="last">
<div><p>per substance stoichiometric coefficient</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;</span><span class="si">%.12g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">equilibrium_quotient</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">,</span> <span class="mf">1e-7</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">&#39;1e-14&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.chemistry.mass_fractions">
<code class="descclassname">chempy.chemistry.</code><code class="descname">mass_fractions</code><span class="sig-paren">(</span><em>stoichiometries</em>, <em>substances=None</em>, <em>substance_factory=&lt;bound method type.from_formula of &lt;class 'chempy.chemistry.Substance'&gt;&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/chemistry.html#mass_fractions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.chemistry.mass_fractions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates weight fractions of each substance in a stoichiometric dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>stoichiometries</strong> : dict or set</p>
<blockquote>
<div><p>If a <code class="docutils literal"><span class="pre">set</span></code>: all entries are assumed to correspond to unit multiplicity.</p>
</div></blockquote>
<p class="last"><strong>substances: dict or None</strong></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">mass_fractions</span><span class="p">({</span><span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mH2</span><span class="p">,</span> <span class="n">mO2</span> <span class="o">=</span> <span class="mf">1.008</span><span class="o">*</span><span class="mi">2</span><span class="p">,</span> <span class="mf">15.999</span><span class="o">*</span><span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;H2&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mH2</span><span class="o">/</span><span class="p">(</span><span class="n">mH2</span><span class="o">+</span><span class="n">mO2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-4</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">r</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">mO2</span><span class="o">/</span><span class="p">(</span><span class="n">mH2</span><span class="o">+</span><span class="n">mO2</span><span class="p">))</span> <span class="o">&lt;</span> <span class="mf">1e-4</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mass_fractions</span><span class="p">({</span><span class="s1">&#39;H2O2&#39;</span><span class="p">})</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;H2O2&#39;</span><span class="p">:</span> <span class="mf">1.0</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-chempy.debye_huckel">
<span id="chempy-debye-huckel-module"></span><h2>chempy.debye_huckel module<a class="headerlink" href="#module-chempy.debye_huckel" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-chempy.einstein_smoluchowski">
<span id="chempy-einstein-smoluchowski-module"></span><h2>chempy.einstein_smoluchowski module<a class="headerlink" href="#module-chempy.einstein_smoluchowski" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="chempy.einstein_smoluchowski.electrical_mobility_from_D">
<code class="descclassname">chempy.einstein_smoluchowski.</code><code class="descname">electrical_mobility_from_D</code><span class="sig-paren">(</span><em>D</em>, <em>charge</em>, <em>T</em>, <em>constants=None</em>, <em>units=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/einstein_smoluchowski.html#electrical_mobility_from_D"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.einstein_smoluchowski.electrical_mobility_from_D" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the electrical mobility through Einstein-Smoluchowski relation.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>D: float with unit</strong></p>
<blockquote>
<div><p>Diffusion coefficient</p>
</div></blockquote>
<p><strong>charge: integer</strong></p>
<blockquote>
<div><p>charge of the species</p>
</div></blockquote>
<p><strong>T: float with unit</strong></p>
<blockquote>
<div><p>Absolute temperature</p>
</div></blockquote>
<p><strong>constants: object (optional, default: None)</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>if None:</dt>
<dd><p class="first last">T assumed to be in Kelvin and b0 = 1 mol/kg</p>
</dd>
<dt>else:</dt>
<dd><p class="first last">see source code for what attributes are used.
Tip: pass quantities.constants</p>
</dd>
</dl>
</div></blockquote>
<p><strong>units: object (optional, default: None)</strong></p>
<blockquote>
<div><p>attributes accessed: meter, Kelvin and mol</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Electrical mobility</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-chempy.electrolytes">
<span id="chempy-electrolytes-module"></span><h2>chempy.electrolytes module<a class="headerlink" href="#module-chempy.electrolytes" title="Permalink to this headline">¶</a></h2>
<p>This modules collects expressions related to ionic strenght, e.g. the Debye-Hückel expressions.</p>
<dl class="function">
<dt id="chempy.electrolytes.A">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">A</code><span class="sig-paren">(</span><em>eps_r</em>, <em>T</em>, <em>rho</em>, <em>b0=1</em>, <em>constants=None</em>, <em>units=None</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#A"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.A" title="Permalink to this definition">¶</a></dt>
<dd><p>Debye Huckel constant A</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>eps_r: float</strong></p>
<blockquote>
<div><p>relative permittivity</p>
</div></blockquote>
<p><strong>T: float with unit</strong></p>
<blockquote>
<div><p>Temperature (default: assume Kelvin)</p>
</div></blockquote>
<p><strong>rho: float with unit</strong></p>
<blockquote>
<div><p>density (default: assume kg/m**3)</p>
</div></blockquote>
<p><strong>b0: float, optional</strong></p>
<blockquote>
<div><p>Reference molality, optionally with unit (amount / mass)
IUPAC defines it as 1 mol/kg. (default: 1).</p>
</div></blockquote>
<p><strong>units: object (optional, default: None)</strong></p>
<blockquote>
<div><p>attributes accessed: meter, Kelvin and mol</p>
</div></blockquote>
<p><strong>constants: object (optional, default: None)</strong></p>
<blockquote class="last">
<div><dl class="docutils">
<dt>if None:</dt>
<dd><p class="first last">T assumed to be in Kelvin and b0 = 1 mol/kg</p>
</dd>
<dt>else:</dt>
<dd><p class="first last">see source code for what attributes are used.
Tip: pass quantities.constants</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>Remember to divide by ln(10) if you want to use the constant
with log10 based expression.</p>
<p class="rubric">References</p>
<p>Atkins, De Paula, Physical Chemistry, 8th edition</p>
</dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.B">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">B</code><span class="sig-paren">(</span><em>eps_r</em>, <em>T</em>, <em>rho</em>, <em>b0=1</em>, <em>constants=None</em>, <em>units=None</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#B"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.B" title="Permalink to this definition">¶</a></dt>
<dd><p>Extended Debye-Huckel parameter B</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>eps_r: float</strong></p>
<blockquote>
<div><p>relative permittivity</p>
</div></blockquote>
<p><strong>T: float with unit</strong></p>
<blockquote>
<div><p>temperature</p>
</div></blockquote>
<p><strong>rho: float with unit</strong></p>
<blockquote>
<div><p>density</p>
</div></blockquote>
<p><strong>b0: float with unit</strong></p>
<blockquote>
<div><p>reference molality</p>
</div></blockquote>
<p><strong>units: object (optional, default: None)</strong></p>
<blockquote>
<div><p>attributes accessed: meter, Kelvin and mol</p>
</div></blockquote>
<p><strong>constants: object (optional, default: None)</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>if None:</dt>
<dd><p class="first last">T assumed to be in Kelvin, rho in kg/m**3 and b0 = 1 mol/kg</p>
</dd>
<dt>else:</dt>
<dd><p class="first last">attributes accessed: molar_gas_constant, Faraday_constant
Tip: pass quantities.constants</p>
</dd>
</dl>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Debye Huckel B constant (default in m**-1)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="chempy.electrolytes.ExtendedDebyeHuckelActivityProduct">
<em class="property">class </em><code class="descclassname">chempy.electrolytes.</code><code class="descname">ExtendedDebyeHuckelActivityProduct</code><span class="sig-paren">(</span><em>stoich</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#ExtendedDebyeHuckelActivityProduct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.ExtendedDebyeHuckelActivityProduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">chempy.electrolytes._ActivityProductBase</span></code></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code>(c)</td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="class">
<dt id="chempy.electrolytes.LimitingDebyeHuckelActivityProduct">
<em class="property">class </em><code class="descclassname">chempy.electrolytes.</code><code class="descname">LimitingDebyeHuckelActivityProduct</code><span class="sig-paren">(</span><em>stoich</em>, <em>*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#LimitingDebyeHuckelActivityProduct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.LimitingDebyeHuckelActivityProduct" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">chempy.electrolytes._ActivityProductBase</span></code></p>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code>(c)</td>
<td></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.davies_activity_product">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">davies_activity_product</code><span class="sig-paren">(</span><em>I</em>, <em>stoich</em>, <em>z</em>, <em>a</em>, <em>T</em>, <em>eps_r</em>, <em>rho</em>, <em>C=-0.3</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#davies_activity_product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.davies_activity_product" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.davies_log_gamma">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">davies_log_gamma</code><span class="sig-paren">(</span><em>I</em>, <em>z</em>, <em>A</em>, <em>C=-0.3</em>, <em>I0=1</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#davies_log_gamma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.davies_log_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Davies formula</p>
</dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.extended_activity_product">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">extended_activity_product</code><span class="sig-paren">(</span><em>I</em>, <em>stoich</em>, <em>z</em>, <em>a</em>, <em>T</em>, <em>eps_r</em>, <em>rho</em>, <em>C=0</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#extended_activity_product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.extended_activity_product" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.extended_log_gamma">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">extended_log_gamma</code><span class="sig-paren">(</span><em>I</em>, <em>z</em>, <em>a</em>, <em>A</em>, <em>B</em>, <em>C=0</em>, <em>I0=1</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#extended_log_gamma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.extended_log_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Debye-Huckel extended formula</p>
</dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.ionic_strength">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">ionic_strength</code><span class="sig-paren">(</span><em>molalities</em>, <em>charges=None</em>, <em>units=None</em>, <em>substances=None</em>, <em>substance_factory=&lt;bound method type.from_formula of &lt;class 'chempy.chemistry.Substance'&gt;&gt;</em>, <em>warn=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#ionic_strength"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.ionic_strength" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the ionic strength</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>molalities: array_like or dict</strong></p>
<blockquote>
<div><p>Optionally with unit (amount / mass).
when dict: mapping substance key to molality.</p>
</div></blockquote>
<p><strong>charges: array_like</strong></p>
<blockquote>
<div><p>Charge of respective ion, taken for substances when None.</p>
</div></blockquote>
<p><strong>units: object (optional, default: None)</strong></p>
<blockquote>
<div><p>Attributes accessed: molal.</p>
</div></blockquote>
<p><strong>substances: dict, optional</strong></p>
<blockquote>
<div><p>Mapping of substance keys to Substance instances (used when molalities
is a dict).</p>
</div></blockquote>
<p><strong>substance_factory: callback</strong></p>
<blockquote>
<div><p>Used if <cite>substances</cite> is a string.</p>
</div></blockquote>
<p><strong>warn: bool</strong></p>
<blockquote class="last">
<div><p>Issue a warning if molalities violates net charge neutrality.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ionic_strength</span><span class="p">([</span><span class="mf">1e-3</span><span class="p">,</span> <span class="mf">3e-3</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="o">.</span><span class="mi">5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">9</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="mf">1e-3</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ionic_strength</span><span class="p">({</span><span class="s1">&#39;Mg+2&#39;</span><span class="p">:</span> <span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;PO4-3&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">})</span>
<span class="go">30.0</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.limiting_activity_product">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">limiting_activity_product</code><span class="sig-paren">(</span><em>I</em>, <em>stoich</em>, <em>z</em>, <em>T</em>, <em>eps_r</em>, <em>rho</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#limiting_activity_product"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.limiting_activity_product" title="Permalink to this definition">¶</a></dt>
<dd><p>Product of activity coefficients based on DH limiting law.</p>
</dd></dl>

<dl class="function">
<dt id="chempy.electrolytes.limiting_log_gamma">
<code class="descclassname">chempy.electrolytes.</code><code class="descname">limiting_log_gamma</code><span class="sig-paren">(</span><em>I</em>, <em>z</em>, <em>A</em>, <em>I0=1</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/electrolytes.html#limiting_log_gamma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.electrolytes.limiting_log_gamma" title="Permalink to this definition">¶</a></dt>
<dd><p>Debye-Hyckel limiting formula</p>
</dd></dl>

</div>
<div class="section" id="module-chempy.equilibria">
<span id="chempy-equilibria-module"></span><h2>chempy.equilibria module<a class="headerlink" href="#module-chempy.equilibria" title="Permalink to this headline">¶</a></h2>
<p>Module collecting classes and functions for dealing with (multiphase) chemical
equilibria.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This module is provisional at the moment, i.e. the API is not stable and may
break without a deprecation cycle.</p>
</div>
<dl class="class">
<dt id="chempy.equilibria.EqSystem">
<em class="property">class </em><code class="descclassname">chempy.equilibria.</code><code class="descname">EqSystem</code><span class="sig-paren">(</span><em>rxns</em>, <em>substances=None</em>, <em>name=None</em>, <em>checks=('balance'</em>, <em>'substance_keys'</em>, <em>'duplicate'</em>, <em>'duplicate_names')</em>, <em>substance_factory=&lt;class 'chempy.chemistry.Substance'&gt;</em>, <em>missing_substances_from_keys=False</em>, <em>sort_substances=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#chempy.reactionsystem.ReactionSystem" title="chempy.reactionsystem.ReactionSystem"><code class="xref py py-class docutils literal"><span class="pre">chempy.reactionsystem.ReactionSystem</span></code></a></p>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">nr</span></code></td>
<td>Number of reactions</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">ns</span></code></td>
<td>Number of substances</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.precipitate_rxn_idxs" title="chempy.equilibria.EqSystem.precipitate_rxn_idxs"><code class="xref py py-obj docutils literal"><span class="pre">precipitate_rxn_idxs</span></code></a></td>
<td>precipitate_rxn_idxs is deprecated since (not including) 0.3.1, it will be missing in 0.5.0. Use phase_transfer_reaction_idxs instead.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.precipitate_substance_idxs" title="chempy.equilibria.EqSystem.precipitate_substance_idxs"><code class="xref py py-obj docutils literal"><span class="pre">precipitate_substance_idxs</span></code></a></td>
<td>precipitate_substance_idxs is deprecated since (not including) 0.3.1, it will be missing in 0.5.0. Use other_phase_species_idxs instead.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">active_prod_stoichs</span></code>([keys])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">active_reac_stoichs</span></code>([keys])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">all_prod_stoichs</span></code>([keys])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">all_reac_stoichs</span></code>([keys])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">as_per_substance_array</span></code>(cont[,&nbsp;dtype,&nbsp;unit,&nbsp;…])</td>
<td>Turns a dict into an ordered array</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">as_per_substance_dict</span></code>(arr)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">as_substance_index</span></code>(substance_key)</td>
<td>Returns the index of a Substance in the system</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">bimolecular_html_table</span></code>(*args,&nbsp;**kwargs)</td>
<td>bimolecular_html_table is deprecated since (not including) 0.5.7, it will be missing in 0.7.0. Use chempy.printing.tables.BimolecularTable instead.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">categorize_substances</span></code>(**kwargs)</td>
<td>Returns categories of substance keys (e.g.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">check_balance</span></code>([strict,&nbsp;throw])</td>
<td>Checks if all reactions are balanced.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">check_duplicate</span></code>([throw])</td>
<td>Raies ValueError if there are duplicates in <code class="docutils literal"><span class="pre">self.rxns</span></code></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">check_duplicate_names</span></code>([throw])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">check_substance_keys</span></code>([throw])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">composition_balance_vectors</span></code>()</td>
<td>Returns a list of lists with compositions and a list of composition keys.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.composition_conservation" title="chempy.equilibria.EqSystem.composition_conservation"><code class="xref py py-obj docutils literal"><span class="pre">composition_conservation</span></code></a>(concs,&nbsp;init_concs)</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.dissolved" title="chempy.equilibria.EqSystem.dissolved"><code class="xref py py-obj docutils literal"><span class="pre">dissolved</span></code></a>(concs)</td>
<td>Return dissolved concentrations</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.eq_constants" title="chempy.equilibria.EqSystem.eq_constants"><code class="xref py py-obj docutils literal"><span class="pre">eq_constants</span></code></a>([non_precip_rids,&nbsp;eq_params,&nbsp;small])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.equilibrium_quotients" title="chempy.equilibria.EqSystem.equilibrium_quotients"><code class="xref py py-obj docutils literal"><span class="pre">equilibrium_quotients</span></code></a>(concs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">from_string</span></code>(s[,&nbsp;substances,&nbsp;rxn_parse_kwargs])</td>
<td>Create a reaction system from a string</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.get_neqsys" title="chempy.equilibria.EqSystem.get_neqsys"><code class="xref py py-obj docutils literal"><span class="pre">get_neqsys</span></code></a>(neqsys_type[,&nbsp;NumSys])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.get_neqsys_chained_conditional" title="chempy.equilibria.EqSystem.get_neqsys_chained_conditional"><code class="xref py py-obj docutils literal"><span class="pre">get_neqsys_chained_conditional</span></code></a>([rref_equil,&nbsp;…])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.get_neqsys_conditional_chained" title="chempy.equilibria.EqSystem.get_neqsys_conditional_chained"><code class="xref py py-obj docutils literal"><span class="pre">get_neqsys_conditional_chained</span></code></a>([rref_equil,&nbsp;…])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.get_neqsys_static_conditions" title="chempy.equilibria.EqSystem.get_neqsys_static_conditions"><code class="xref py py-obj docutils literal"><span class="pre">get_neqsys_static_conditions</span></code></a>([rref_equil,&nbsp;…])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.html" title="chempy.equilibria.EqSystem.html"><code class="xref py py-obj docutils literal"><span class="pre">html</span></code></a>(*args,&nbsp;**kwargs)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">identify_equilibria</span></code>()</td>
<td>Returns a list of index pairs of reactions forming equilibria.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">net_stoichs</span></code>([keys])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.non_precip_rids" title="chempy.equilibria.EqSystem.non_precip_rids"><code class="xref py py-obj docutils literal"><span class="pre">non_precip_rids</span></code></a>(precipitates)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">obeys_charge_neutrality</span></code>()</td>
<td>Returns False if any reaction violate charge neutrality.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">obeys_mass_balance</span></code>()</td>
<td>Returns True if all reactions obeys mass balance, else False.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.other_phase_species_idxs" title="chempy.equilibria.EqSystem.other_phase_species_idxs"><code class="xref py py-obj docutils literal"><span class="pre">other_phase_species_idxs</span></code></a>([phase_idx])</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">params</span></code>()</td>
<td>Returns list of per reaction <code class="docutils literal"><span class="pre">param</span></code> value</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">per_reaction_effect_on_substance</span></code>(substance_key)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">per_substance_varied</span></code>(per_substance[,&nbsp;varied])</td>
<td>Dense nd-array for all combinations of varied levels per substance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.phase_transfer_reaction_idxs" title="chempy.equilibria.EqSystem.phase_transfer_reaction_idxs"><code class="xref py py-obj docutils literal"><span class="pre">phase_transfer_reaction_idxs</span></code></a>([phase_idx])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.plot_errors" title="chempy.equilibria.EqSystem.plot_errors"><code class="xref py py-obj docutils literal"><span class="pre">plot_errors</span></code></a>(concs,&nbsp;init_concs,&nbsp;varied_data,&nbsp;…)</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">rates</span></code>([variables,&nbsp;backend,&nbsp;substance_keys,&nbsp;…])</td>
<td>Per substance sums of reaction rates rates.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.root" title="chempy.equilibria.EqSystem.root"><code class="xref py py-obj docutils literal"><span class="pre">root</span></code></a>(init_concs[,&nbsp;x0,&nbsp;neqsys,&nbsp;NumSys,&nbsp;…])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.roots" title="chempy.equilibria.EqSystem.roots"><code class="xref py py-obj docutils literal"><span class="pre">roots</span></code></a>(init_concs,&nbsp;varied_data,&nbsp;varied[,&nbsp;x0,&nbsp;…])</td>
<td><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.solve" title="chempy.equilibria.EqSystem.solve"><code class="xref py py-obj docutils literal"><span class="pre">solve</span></code></a>(init_concs[,&nbsp;varied])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">sort_substances_inplace</span></code>([key])</td>
<td>Sorts the OrderedDict attribute <code class="docutils literal"><span class="pre">substances</span></code></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">split</span></code>(**kwargs)</td>
<td>Splits the reaction system into multiple disjoint reaction systems.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">stoichs</span></code>([non_precip_rids])</td>
<td>Conditional stoichiometries depending on precipitation status</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.stoichs_constants" title="chempy.equilibria.EqSystem.stoichs_constants"><code class="xref py py-obj docutils literal"><span class="pre">stoichs_constants</span></code></a>([eq_params,&nbsp;rref,&nbsp;Matrix,&nbsp;…])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">string</span></code>([with_param])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.equilibria.EqSystem.substance_labels" title="chempy.equilibria.EqSystem.substance_labels"><code class="xref py py-obj docutils literal"><span class="pre">substance_labels</span></code></a>([latex])</td>
<td></td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">substance_names</span></code>()</td>
<td>Returns a tuple of the substances’ names</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">substance_participation</span></code>(substance_key)</td>
<td>Returns indices of reactions where substance_key occurs</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">unimolecular_html_table</span></code>(*args,&nbsp;**kwargs)</td>
<td>unimolecular_html_table is deprecated since (not including) 0.5.7, it will be missing in 0.7.0. Use chempy.printing.tables.UnimolecularTable instead.</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">upper_conc_bounds</span></code>(init_concs[,&nbsp;min_,&nbsp;dtype,&nbsp;…])</td>
<td>Calculates upper concentration bounds per substance based on substance composition.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chempy.equilibria.EqSystem.composition_conservation">
<code class="descname">composition_conservation</code><span class="sig-paren">(</span><em>concs</em>, <em>init_concs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.composition_conservation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.composition_conservation" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.dissolved">
<code class="descname">dissolved</code><span class="sig-paren">(</span><em>concs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.dissolved"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.dissolved" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dissolved concentrations</p>
</dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.eq_constants">
<code class="descname">eq_constants</code><span class="sig-paren">(</span><em>non_precip_rids=()</em>, <em>eq_params=None</em>, <em>small=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.eq_constants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.eq_constants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.equilibrium_quotients">
<code class="descname">equilibrium_quotients</code><span class="sig-paren">(</span><em>concs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.equilibrium_quotients"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.equilibrium_quotients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.get_neqsys">
<code class="descname">get_neqsys</code><span class="sig-paren">(</span><em>neqsys_type</em>, <em>NumSys=&lt;class 'chempy._eqsys.NumSysLin'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.get_neqsys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.get_neqsys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.get_neqsys_chained_conditional">
<code class="descname">get_neqsys_chained_conditional</code><span class="sig-paren">(</span><em>rref_equil=False</em>, <em>rref_preserv=False</em>, <em>NumSys=&lt;class 'chempy._eqsys.NumSysLin'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.get_neqsys_chained_conditional"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.get_neqsys_chained_conditional" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.get_neqsys_conditional_chained">
<code class="descname">get_neqsys_conditional_chained</code><span class="sig-paren">(</span><em>rref_equil=False</em>, <em>rref_preserv=False</em>, <em>NumSys=&lt;class 'chempy._eqsys.NumSysLin'&gt;</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.get_neqsys_conditional_chained"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.get_neqsys_conditional_chained" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.get_neqsys_static_conditions">
<code class="descname">get_neqsys_static_conditions</code><span class="sig-paren">(</span><em>rref_equil=False</em>, <em>rref_preserv=False</em>, <em>NumSys=(&lt;class 'chempy._eqsys.NumSysLin'&gt;</em>, <em>)</em>, <em>precipitates=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.get_neqsys_static_conditions"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.get_neqsys_static_conditions" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.html">
<code class="descname">html</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.html"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.html" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.non_precip_rids">
<code class="descname">non_precip_rids</code><span class="sig-paren">(</span><em>precipitates</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.non_precip_rids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.non_precip_rids" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.other_phase_species_idxs">
<code class="descname">other_phase_species_idxs</code><span class="sig-paren">(</span><em>phase_idx=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.other_phase_species_idxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.other_phase_species_idxs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.phase_transfer_reaction_idxs">
<code class="descname">phase_transfer_reaction_idxs</code><span class="sig-paren">(</span><em>phase_idx=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.phase_transfer_reaction_idxs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.phase_transfer_reaction_idxs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.plot_errors">
<code class="descname">plot_errors</code><span class="sig-paren">(</span><em>concs</em>, <em>init_concs</em>, <em>varied_data</em>, <em>varied</em>, <em>axes=None</em>, <em>compositions=True</em>, <em>Q=True</em>, <em>subplot_kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.plot_errors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.plot_errors" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="chempy.equilibria.EqSystem.precipitate_rxn_idxs">
<code class="descname">precipitate_rxn_idxs</code><a class="headerlink" href="#chempy.equilibria.EqSystem.precipitate_rxn_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>precipitate_rxn_idxs is deprecated since (not including) 0.3.1, it will be missing in 0.5.0. Use phase_transfer_reaction_idxs instead.</p>
</dd></dl>

<dl class="attribute">
<dt id="chempy.equilibria.EqSystem.precipitate_substance_idxs">
<code class="descname">precipitate_substance_idxs</code><a class="headerlink" href="#chempy.equilibria.EqSystem.precipitate_substance_idxs" title="Permalink to this definition">¶</a></dt>
<dd><p>precipitate_substance_idxs is deprecated since (not including) 0.3.1, it will be missing in 0.5.0. Use other_phase_species_idxs instead.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.root">
<code class="descname">root</code><span class="sig-paren">(</span><em>init_concs</em>, <em>x0=None</em>, <em>neqsys=None</em>, <em>NumSys=&lt;class 'chempy._eqsys.NumSysLog'&gt;</em>, <em>neqsys_type='chained_conditional'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.root"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.root" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.roots">
<code class="descname">roots</code><span class="sig-paren">(</span><em>init_concs</em>, <em>varied_data</em>, <em>varied</em>, <em>x0=None</em>, <em>NumSys=&lt;class 'chempy._eqsys.NumSysLog'&gt;</em>, <em>plot_kwargs=None</em>, <em>neqsys_type='chained_conditional'</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.roots"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.roots" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>init_concs</strong> : array or dict</p>
<p><strong>varied_data</strong> : array</p>
<p><strong>varied_idx</strong> : int or str</p>
<p><strong>x0</strong> : array</p>
<p><strong>NumSys</strong> : _NumSys subclass</p>
<blockquote>
<div><p>See <code class="xref py py-class docutils literal"><span class="pre">NumSysLin</span></code>, <code class="xref py py-class docutils literal"><span class="pre">NumSysLog</span></code>, etc.</p>
</div></blockquote>
<p><strong>plot_kwargs</strong> : dict</p>
<blockquote>
<div><p>See py:meth:<cite>pyneqsys.NeqSys.solve</cite>. Two additional keys
are intercepted here:</p>
<blockquote>
<div><p>latex_names: bool (default: False)
conc_unit_str: str (default: ‘M’)</p>
</div></blockquote>
</div></blockquote>
<p><strong>neqsys_type</strong> : str</p>
<blockquote>
<div><p>what method to use for NeqSys construction (get_neqsys_*)</p>
</div></blockquote>
<p><strong>**kwargs :</strong></p>
<blockquote class="last">
<div><p>Keyword argumetns passed on to py:meth:<cite>pyneqsys.NeqSys.solve_series</cite>.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.solve">
<code class="descname">solve</code><span class="sig-paren">(</span><em>init_concs</em>, <em>varied=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.solve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.solve" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.stoichs_constants">
<code class="descname">stoichs_constants</code><span class="sig-paren">(</span><em>eq_params=None</em>, <em>rref=False</em>, <em>Matrix=None</em>, <em>backend=None</em>, <em>non_precip_rids=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.stoichs_constants"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.stoichs_constants" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.equilibria.EqSystem.substance_labels">
<code class="descname">substance_labels</code><span class="sig-paren">(</span><em>latex=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/equilibria.html#EqSystem.substance_labels"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.equilibria.EqSystem.substance_labels" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chempy.eyring">
<span id="chempy-eyring-module"></span><h2>chempy.eyring module<a class="headerlink" href="#module-chempy.eyring" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-chempy.henry">
<span id="chempy-henry-module"></span><h2>chempy.henry module<a class="headerlink" href="#module-chempy.henry" title="Permalink to this headline">¶</a></h2>
<p>Module for dealing with constants <a class="reference external" href="https://en.wikipedia.org/wiki/Henry's_law">Henry’s law</a>.</p>
<dl class="class">
<dt id="chempy.henry.Henry">
<em class="property">class </em><code class="descclassname">chempy.henry.</code><code class="descname">Henry</code><a class="reference internal" href="_modules/chempy/henry.html#Henry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.henry.Henry" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">chempy.util.pyutil.Henry</span></code></p>
<p>Henry’s gas constant</p>
<p>Note that the reference temperature
is set by the attribute <code class="xref py py-attr docutils literal"><span class="pre">T0</span></code> which defaults to
298.15 (Kelvin).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>Hcp: float</strong></p>
<blockquote>
<div><p>Henry’s constant [M/atm]</p>
</div></blockquote>
<p><strong>Tderiv: float</strong></p>
<blockquote>
<div><p>dln(kH)/d(1/T) [K]
Equivalent to $Delta_{soln}H / R$</p>
</div></blockquote>
<p><strong>ref: object</strong></p>
<blockquote>
<div><p>Reference for origin of parameters</p>
</div></blockquote>
<p><strong>units: object (optional)</strong></p>
<blockquote class="last">
<div><p>object with attributes: kelvin</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">H_H2</span> <span class="o">=</span> <span class="n">Henry</span><span class="p">(</span><span class="mf">1.2e-3</span><span class="p">,</span> <span class="mi">1800</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;carpenter_1966&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;</span><span class="si">%.2g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">H_H2</span><span class="p">(</span><span class="mf">298.15</span><span class="p">)</span>
<span class="go">&#39;0.0012&#39;</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">Hcp</span></code></td>
<td>Alias for field number 0</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">T0</span></code></td>
<td>Alias for field number 2</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">Tderiv</span></code></td>
<td>Alias for field number 1</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">ref</span></code></td>
<td>Alias for field number 3</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code>(T[,&nbsp;units,&nbsp;backend])</td>
<td>Evaluates Henry’s constant for provided temperature</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">count</span></code>(…)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.henry.Henry.get_P_at_T_and_c" title="chempy.henry.Henry.get_P_at_T_and_c"><code class="xref py py-obj docutils literal"><span class="pre">get_P_at_T_and_c</span></code></a>(T,&nbsp;c,&nbsp;**kwargs)</td>
<td>Convenience method for calculating concentration</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.henry.Henry.get_c_at_T_and_P" title="chempy.henry.Henry.get_c_at_T_and_P"><code class="xref py py-obj docutils literal"><span class="pre">get_c_at_T_and_P</span></code></a>(T,&nbsp;P,&nbsp;**kwargs)</td>
<td>Convenience method for calculating concentration</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.henry.Henry.get_kH_at_T" title="chempy.henry.Henry.get_kH_at_T"><code class="xref py py-obj docutils literal"><span class="pre">get_kH_at_T</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>get_kH_at_T is deprecated since (not including) 0.3.1, it will be missing in 0.5.0. Use __call__ instead.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">index</span></code>((value,&nbsp;[start,&nbsp;…)</td>
<td>Raises ValueError if the value is not present.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chempy.henry.Henry.get_P_at_T_and_c">
<code class="descname">get_P_at_T_and_c</code><span class="sig-paren">(</span><em>T</em>, <em>c</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/henry.html#Henry.get_P_at_T_and_c"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.henry.Henry.get_P_at_T_and_c" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method for calculating concentration</p>
<p>Calculate the partial pressure for given temperature and concentration</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T: float</strong></p>
<blockquote>
<div><p>Temperature</p>
</div></blockquote>
<p><strong>P: float</strong></p>
<blockquote>
<div><p>Pressure</p>
</div></blockquote>
<p><strong>**kwargs:</strong></p>
<blockquote class="last">
<div><p>Keyword arguments passed on to <code class="xref py py-meth docutils literal"><span class="pre">__call__()</span></code></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.henry.Henry.get_c_at_T_and_P">
<code class="descname">get_c_at_T_and_P</code><span class="sig-paren">(</span><em>T</em>, <em>P</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/henry.html#Henry.get_c_at_T_and_P"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.henry.Henry.get_c_at_T_and_P" title="Permalink to this definition">¶</a></dt>
<dd><p>Convenience method for calculating concentration</p>
<p>Calculate what concentration is needed to achieve a given partial
pressure at a specified temperature</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T: float</strong></p>
<blockquote>
<div><p>Temperature</p>
</div></blockquote>
<p><strong>P: float</strong></p>
<blockquote>
<div><p>Pressure</p>
</div></blockquote>
<p><strong>**kwargs:</strong></p>
<blockquote class="last">
<div><p>Keyword arguments passed on to <code class="xref py py-meth docutils literal"><span class="pre">__call__()</span></code></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.henry.Henry.get_kH_at_T">
<code class="descname">get_kH_at_T</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/henry.html#Henry.get_kH_at_T"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.henry.Henry.get_kH_at_T" title="Permalink to this definition">¶</a></dt>
<dd><p>get_kH_at_T is deprecated since (not including) 0.3.1, it will be missing in 0.5.0. Use __call__ instead.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="chempy.henry.HenryWithUnits">
<em class="property">class </em><code class="descclassname">chempy.henry.</code><code class="descname">HenryWithUnits</code><a class="reference internal" href="_modules/chempy/henry.html#HenryWithUnits"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.henry.HenryWithUnits" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#chempy.henry.Henry" title="chempy.henry.Henry"><code class="xref py py-class docutils literal"><span class="pre">chempy.henry.Henry</span></code></a></p>
<p>Analogous to <a class="reference internal" href="#chempy.henry.Henry" title="chempy.henry.Henry"><code class="xref py py-class docutils literal"><span class="pre">Henry</span></code></a></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.units</span> <span class="k">import</span> <span class="n">to_unitless</span><span class="p">,</span> <span class="n">default_units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">H_CO</span> <span class="o">=</span> <span class="n">HenryWithUnits</span><span class="p">(</span><span class="mf">9.7e-6</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mol</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">3</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">Pa</span><span class="p">,</span> <span class="mi">1300</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="s1">&#39;sander_2015&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;</span><span class="si">%.2g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">to_unitless</span><span class="p">(</span><span class="n">H_CO</span><span class="p">(</span><span class="mf">298.15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">K</span><span class="p">),</span> <span class="n">u</span><span class="o">.</span><span class="n">molar</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">bar</span><span class="p">)</span>
<span class="go">&#39;0.00097&#39;</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">Hcp</span></code></td>
<td>Alias for field number 0</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">T0</span></code></td>
<td>Alias for field number 2</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">Tderiv</span></code></td>
<td>Alias for field number 1</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">ref</span></code></td>
<td>Alias for field number 3</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">__call__</span></code>(T[,&nbsp;units,&nbsp;backend])</td>
<td>Evaluates Henry’s constant for provided temperature</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">count</span></code>(…)</td>
<td></td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">get_P_at_T_and_c</span></code>(T,&nbsp;c,&nbsp;**kwargs)</td>
<td>Convenience method for calculating concentration</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">get_c_at_T_and_P</span></code>(T,&nbsp;P,&nbsp;**kwargs)</td>
<td>Convenience method for calculating concentration</td>
</tr>
<tr class="row-odd"><td><code class="xref py py-obj docutils literal"><span class="pre">get_kH_at_T</span></code>(*args,&nbsp;**kwargs)</td>
<td>get_kH_at_T is deprecated since (not including) 0.3.1, it will be missing in 0.5.0. Use __call__ instead.</td>
</tr>
<tr class="row-even"><td><code class="xref py py-obj docutils literal"><span class="pre">index</span></code>((value,&nbsp;[start,&nbsp;…)</td>
<td>Raises ValueError if the value is not present.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="chempy.henry.Henry_H_at_T">
<code class="descclassname">chempy.henry.</code><code class="descname">Henry_H_at_T</code><span class="sig-paren">(</span><em>T</em>, <em>H</em>, <em>Tderiv</em>, <em>T0=None</em>, <em>units=None</em>, <em>backend=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/henry.html#Henry_H_at_T"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.henry.Henry_H_at_T" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate Henry’s constant H at temperature T</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>T: float</strong></p>
<blockquote>
<div><p>Temperature (with units), assumed to be in Kelvin if <code class="docutils literal"><span class="pre">units</span> <span class="pre">==</span> <span class="pre">None</span></code></p>
</div></blockquote>
<p><strong>H: float</strong></p>
<blockquote>
<div><p>Henry’s constant</p>
</div></blockquote>
<p><strong>Tderiv: float (optional)</strong></p>
<blockquote>
<div><p>dln(H)/d(1/T), assumed to be in Kelvin if <code class="docutils literal"><span class="pre">units</span> <span class="pre">==</span> <span class="pre">None</span></code>.</p>
</div></blockquote>
<p><strong>T0: float</strong></p>
<blockquote>
<div><p>Reference temperature, assumed to be in Kelvin if <code class="docutils literal"><span class="pre">units</span> <span class="pre">==</span> <span class="pre">None</span></code>
default: 298.15 K</p>
</div></blockquote>
<p><strong>units: object (optional)</strong></p>
<blockquote>
<div><p>object with attributes: kelvin (e.g. chempy.units.default_units)</p>
</div></blockquote>
<p><strong>backend</strong> : module (optional)</p>
<blockquote class="last">
<div><p>module with “exp”, default: numpy, math</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-chempy.reactionsystem">
<span id="chempy-reactionsystem-module"></span><h2>chempy.reactionsystem module<a class="headerlink" href="#module-chempy.reactionsystem" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="chempy.reactionsystem.ReactionSystem">
<em class="property">class </em><code class="descclassname">chempy.reactionsystem.</code><code class="descname">ReactionSystem</code><span class="sig-paren">(</span><em>rxns</em>, <em>substances=None</em>, <em>name=None</em>, <em>checks=('balance'</em>, <em>'substance_keys'</em>, <em>'duplicate'</em>, <em>'duplicate_names')</em>, <em>substance_factory=&lt;class 'chempy.chemistry.Substance'&gt;</em>, <em>missing_substances_from_keys=False</em>, <em>sort_substances=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Collection of reactions forming a system (model).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>rxns</strong> : sequence</p>
<blockquote>
<div><p>Sequence of <code class="xref py py-class docutils literal"><span class="pre">Reaction</span></code> instances.</p>
</div></blockquote>
<p><strong>substances</strong> : OrderedDict or string or None</p>
<blockquote>
<div><p>Mapping str -&gt; Substance instances, None =&gt; deduced from reactions.
If a set is passed as substances (or a string which is split), then
<code class="docutils literal"><span class="pre">substance_factory</span></code> will be used to construct substances from the items.</p>
</div></blockquote>
<p><strong>name</strong> : string (optional)</p>
<blockquote>
<div><p>Name of ReactionSystem (e.g. model name / citation key).</p>
</div></blockquote>
<p><strong>checks</strong> : iterable of str, optional</p>
<blockquote>
<div><p>Raises <code class="docutils literal"><span class="pre">ValueError</span></code> if any method <code class="docutils literal"><span class="pre">check_%s</span></code> returns False
for all <code class="docutils literal"><span class="pre">%s</span></code> in <code class="docutils literal"><span class="pre">checks</span></code>.</p>
</div></blockquote>
<p><strong>substance_factory</strong> : callback</p>
<blockquote>
<div><p>Could also be e.g. <code class="xref py py-meth docutils literal"><span class="pre">Substance.from_formula()</span></code>.</p>
</div></blockquote>
<p><strong>sort_substances</strong> : bool</p>
<blockquote>
<div><p>Sort keys in substances lexicographically by key? default: <code class="docutils literal"><span class="pre">None</span></code> implies
True unless substances is either one of <code class="docutils literal"><span class="pre">OrderedDict</span></code>, list, tuple or str.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Raises:</th><td class="field-body"><p class="first"><strong>ValueError</strong></p>
<blockquote class="last">
<div><p>When any reaction occurs more than once</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy</span> <span class="k">import</span> <span class="n">Reaction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r1</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">({</span><span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mf">42.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsys</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="p">([</span><span class="n">r1</span><span class="p">],</span> <span class="s1">&#39;R1 P1&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsys</span><span class="o">.</span><span class="n">as_per_substance_array</span><span class="p">({</span><span class="s1">&#39;R1&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;P1&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">})</span>
<span class="go">array([ 2.,  3.])</span>
</pre></div>
</div>
<p class="rubric">Attributes</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.ns" title="chempy.reactionsystem.ReactionSystem.ns"><code class="xref py py-obj docutils literal"><span class="pre">ns</span></code></a></td>
<td>Number of substances</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.nr" title="chempy.reactionsystem.ReactionSystem.nr"><code class="xref py py-obj docutils literal"><span class="pre">nr</span></code></a></td>
<td>Number of reactions</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>rxns</strong></td>
<td>(list of objects) Sequence of <code class="xref py py-class docutils literal"><span class="pre">Reaction</span></code> instances.</td>
</tr>
<tr class="row-even"><td><strong>substances</strong></td>
<td>(OrderedDict or string or iterable of strings/Substance) Mapping substance name to substance index.</td>
</tr>
</tbody>
</table>
<p class="rubric">Methods</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="10%" />
<col width="90%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.active_prod_stoichs" title="chempy.reactionsystem.ReactionSystem.active_prod_stoichs"><code class="xref py py-obj docutils literal"><span class="pre">active_prod_stoichs</span></code></a>([keys])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.active_reac_stoichs" title="chempy.reactionsystem.ReactionSystem.active_reac_stoichs"><code class="xref py py-obj docutils literal"><span class="pre">active_reac_stoichs</span></code></a>([keys])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.all_prod_stoichs" title="chempy.reactionsystem.ReactionSystem.all_prod_stoichs"><code class="xref py py-obj docutils literal"><span class="pre">all_prod_stoichs</span></code></a>([keys])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.all_reac_stoichs" title="chempy.reactionsystem.ReactionSystem.all_reac_stoichs"><code class="xref py py-obj docutils literal"><span class="pre">all_reac_stoichs</span></code></a>([keys])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.as_per_substance_array" title="chempy.reactionsystem.ReactionSystem.as_per_substance_array"><code class="xref py py-obj docutils literal"><span class="pre">as_per_substance_array</span></code></a>(cont[,&nbsp;dtype,&nbsp;unit,&nbsp;…])</td>
<td>Turns a dict into an ordered array</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.as_per_substance_dict" title="chempy.reactionsystem.ReactionSystem.as_per_substance_dict"><code class="xref py py-obj docutils literal"><span class="pre">as_per_substance_dict</span></code></a>(arr)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.as_substance_index" title="chempy.reactionsystem.ReactionSystem.as_substance_index"><code class="xref py py-obj docutils literal"><span class="pre">as_substance_index</span></code></a>(substance_key)</td>
<td>Returns the index of a Substance in the system</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.bimolecular_html_table" title="chempy.reactionsystem.ReactionSystem.bimolecular_html_table"><code class="xref py py-obj docutils literal"><span class="pre">bimolecular_html_table</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>bimolecular_html_table is deprecated since (not including) 0.5.7, it will be missing in 0.7.0. Use chempy.printing.tables.BimolecularTable instead.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.categorize_substances" title="chempy.reactionsystem.ReactionSystem.categorize_substances"><code class="xref py py-obj docutils literal"><span class="pre">categorize_substances</span></code></a>(**kwargs)</td>
<td>Returns categories of substance keys (e.g.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.check_balance" title="chempy.reactionsystem.ReactionSystem.check_balance"><code class="xref py py-obj docutils literal"><span class="pre">check_balance</span></code></a>([strict,&nbsp;throw])</td>
<td>Checks if all reactions are balanced.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.check_duplicate" title="chempy.reactionsystem.ReactionSystem.check_duplicate"><code class="xref py py-obj docutils literal"><span class="pre">check_duplicate</span></code></a>([throw])</td>
<td>Raies ValueError if there are duplicates in <code class="docutils literal"><span class="pre">self.rxns</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.check_duplicate_names" title="chempy.reactionsystem.ReactionSystem.check_duplicate_names"><code class="xref py py-obj docutils literal"><span class="pre">check_duplicate_names</span></code></a>([throw])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.check_substance_keys" title="chempy.reactionsystem.ReactionSystem.check_substance_keys"><code class="xref py py-obj docutils literal"><span class="pre">check_substance_keys</span></code></a>([throw])</td>
<td></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.composition_balance_vectors" title="chempy.reactionsystem.ReactionSystem.composition_balance_vectors"><code class="xref py py-obj docutils literal"><span class="pre">composition_balance_vectors</span></code></a>()</td>
<td>Returns a list of lists with compositions and a list of composition keys.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.from_string" title="chempy.reactionsystem.ReactionSystem.from_string"><code class="xref py py-obj docutils literal"><span class="pre">from_string</span></code></a>(s[,&nbsp;substances,&nbsp;rxn_parse_kwargs])</td>
<td>Create a reaction system from a string</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.html" title="chempy.reactionsystem.ReactionSystem.html"><code class="xref py py-obj docutils literal"><span class="pre">html</span></code></a>([with_param,&nbsp;checks,&nbsp;color_categories,&nbsp;…])</td>
<td>Returns a string with an HTML representation</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.identify_equilibria" title="chempy.reactionsystem.ReactionSystem.identify_equilibria"><code class="xref py py-obj docutils literal"><span class="pre">identify_equilibria</span></code></a>()</td>
<td>Returns a list of index pairs of reactions forming equilibria.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.net_stoichs" title="chempy.reactionsystem.ReactionSystem.net_stoichs"><code class="xref py py-obj docutils literal"><span class="pre">net_stoichs</span></code></a>([keys])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.obeys_charge_neutrality" title="chempy.reactionsystem.ReactionSystem.obeys_charge_neutrality"><code class="xref py py-obj docutils literal"><span class="pre">obeys_charge_neutrality</span></code></a>()</td>
<td>Returns False if any reaction violate charge neutrality.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.obeys_mass_balance" title="chempy.reactionsystem.ReactionSystem.obeys_mass_balance"><code class="xref py py-obj docutils literal"><span class="pre">obeys_mass_balance</span></code></a>()</td>
<td>Returns True if all reactions obeys mass balance, else False.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.params" title="chempy.reactionsystem.ReactionSystem.params"><code class="xref py py-obj docutils literal"><span class="pre">params</span></code></a>()</td>
<td>Returns list of per reaction <code class="docutils literal"><span class="pre">param</span></code> value</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.per_reaction_effect_on_substance" title="chempy.reactionsystem.ReactionSystem.per_reaction_effect_on_substance"><code class="xref py py-obj docutils literal"><span class="pre">per_reaction_effect_on_substance</span></code></a>(substance_key)</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.per_substance_varied" title="chempy.reactionsystem.ReactionSystem.per_substance_varied"><code class="xref py py-obj docutils literal"><span class="pre">per_substance_varied</span></code></a>(per_substance[,&nbsp;varied])</td>
<td>Dense nd-array for all combinations of varied levels per substance</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.rates" title="chempy.reactionsystem.ReactionSystem.rates"><code class="xref py py-obj docutils literal"><span class="pre">rates</span></code></a>([variables,&nbsp;backend,&nbsp;substance_keys,&nbsp;…])</td>
<td>Per substance sums of reaction rates rates.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.sort_substances_inplace" title="chempy.reactionsystem.ReactionSystem.sort_substances_inplace"><code class="xref py py-obj docutils literal"><span class="pre">sort_substances_inplace</span></code></a>([key])</td>
<td>Sorts the OrderedDict attribute <code class="docutils literal"><span class="pre">substances</span></code></td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.split" title="chempy.reactionsystem.ReactionSystem.split"><code class="xref py py-obj docutils literal"><span class="pre">split</span></code></a>(**kwargs)</td>
<td>Splits the reaction system into multiple disjoint reaction systems.</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.stoichs" title="chempy.reactionsystem.ReactionSystem.stoichs"><code class="xref py py-obj docutils literal"><span class="pre">stoichs</span></code></a>([non_precip_rids])</td>
<td>Conditional stoichiometries depending on precipitation status</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.string" title="chempy.reactionsystem.ReactionSystem.string"><code class="xref py py-obj docutils literal"><span class="pre">string</span></code></a>([with_param])</td>
<td></td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.substance_names" title="chempy.reactionsystem.ReactionSystem.substance_names"><code class="xref py py-obj docutils literal"><span class="pre">substance_names</span></code></a>()</td>
<td>Returns a tuple of the substances’ names</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.substance_participation" title="chempy.reactionsystem.ReactionSystem.substance_participation"><code class="xref py py-obj docutils literal"><span class="pre">substance_participation</span></code></a>(substance_key)</td>
<td>Returns indices of reactions where substance_key occurs</td>
</tr>
<tr class="row-odd"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.unimolecular_html_table" title="chempy.reactionsystem.ReactionSystem.unimolecular_html_table"><code class="xref py py-obj docutils literal"><span class="pre">unimolecular_html_table</span></code></a>(*args,&nbsp;**kwargs)</td>
<td>unimolecular_html_table is deprecated since (not including) 0.5.7, it will be missing in 0.7.0. Use chempy.printing.tables.UnimolecularTable instead.</td>
</tr>
<tr class="row-even"><td><a class="reference internal" href="#chempy.reactionsystem.ReactionSystem.upper_conc_bounds" title="chempy.reactionsystem.ReactionSystem.upper_conc_bounds"><code class="xref py py-obj docutils literal"><span class="pre">upper_conc_bounds</span></code></a>(init_concs[,&nbsp;min_,&nbsp;dtype,&nbsp;…])</td>
<td>Calculates upper concentration bounds per substance based on substance composition.</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.active_prod_stoichs">
<code class="descname">active_prod_stoichs</code><span class="sig-paren">(</span><em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.active_prod_stoichs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.active_prod_stoichs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.active_reac_stoichs">
<code class="descname">active_reac_stoichs</code><span class="sig-paren">(</span><em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.active_reac_stoichs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.active_reac_stoichs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.all_prod_stoichs">
<code class="descname">all_prod_stoichs</code><span class="sig-paren">(</span><em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.all_prod_stoichs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.all_prod_stoichs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.all_reac_stoichs">
<code class="descname">all_reac_stoichs</code><span class="sig-paren">(</span><em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.all_reac_stoichs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.all_reac_stoichs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.as_per_substance_array">
<code class="descname">as_per_substance_array</code><span class="sig-paren">(</span><em>cont</em>, <em>dtype='float64'</em>, <em>unit=None</em>, <em>raise_on_unk=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.as_per_substance_array"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.as_per_substance_array" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns a dict into an ordered array</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>cont</strong> : array_like or dict</p>
<p><strong>dtype</strong> : str or numpy.dtype object</p>
<p><strong>unit</strong> : unit, optional</p>
<p class="last"><strong>raise_on_unk</strong> : bool</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.as_per_substance_dict">
<code class="descname">as_per_substance_dict</code><span class="sig-paren">(</span><em>arr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.as_per_substance_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.as_per_substance_dict" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.as_substance_index">
<code class="descname">as_substance_index</code><span class="sig-paren">(</span><em>substance_key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.as_substance_index"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.as_substance_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the index of a Substance in the system</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.bimolecular_html_table">
<code class="descname">bimolecular_html_table</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.bimolecular_html_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.bimolecular_html_table" title="Permalink to this definition">¶</a></dt>
<dd><p>bimolecular_html_table is deprecated since (not including) 0.5.7, it will be missing in 0.7.0. Use chempy.printing.tables.BimolecularTable instead.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.categorize_substances">
<code class="descname">categorize_substances</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.categorize_substances"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.categorize_substances" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns categories of substance keys (e.g. nonparticipating, unaffected etc.)</p>
<p>Some substances are only <em>accumulated</em> (i.e. irreversibly formed) and are never net
reactants in any reactions, others are <em>depleted</em> (they are never net proucts in
any reaction). Some substanaces are <em>unaffected</em> since they appear with equal coefficients on
both reactant and product side, while some may be <em>nonparticipating</em> (they don’t appear on
either side and have thus no effect on the reactionsystem).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>**kwargs:</strong></p>
<blockquote>
<div><p>Keyword arguments passed on to <a class="reference internal" href="#chempy.reactionsystem.ReactionSystem" title="chempy.reactionsystem.ReactionSystem"><code class="xref py py-class docutils literal"><span class="pre">ReactionSystem</span></code></a>.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">dict of sets of substance keys, the dictionary has the following keys:</p>
<blockquote class="last">
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">'accumulated'</span></code>: keys only participating as net products.</li>
<li><code class="docutils literal"><span class="pre">'depleted'</span></code>: keys only participating as net reactants.</li>
<li><code class="docutils literal"><span class="pre">'unaffected'</span></code>: keys appearing in reactions but with zero net effect.</li>
<li><code class="docutils literal"><span class="pre">'nonparticipating'</span></code>: keys not appearing in any reactions.</li>
</ul>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.check_balance">
<code class="descname">check_balance</code><span class="sig-paren">(</span><em>strict=False</em>, <em>throw=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.check_balance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.check_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if all reactions are balanced.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>strict</strong> : bool</p>
<blockquote>
<div><p>Puts a requirement on all substances to have their <code class="docutils literal"><span class="pre">composition</span></code> attribute set.</p>
</div></blockquote>
<p><strong>throw</strong> : bool</p>
<blockquote class="last">
<div><p>Raies ValueError if there are unbalanecd reactions in self.rxns</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.check_duplicate">
<code class="descname">check_duplicate</code><span class="sig-paren">(</span><em>throw=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.check_duplicate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.check_duplicate" title="Permalink to this definition">¶</a></dt>
<dd><p>Raies ValueError if there are duplicates in <code class="docutils literal"><span class="pre">self.rxns</span></code></p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.check_duplicate_names">
<code class="descname">check_duplicate_names</code><span class="sig-paren">(</span><em>throw=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.check_duplicate_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.check_duplicate_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.check_substance_keys">
<code class="descname">check_substance_keys</code><span class="sig-paren">(</span><em>throw=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.check_substance_keys"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.check_substance_keys" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.composition_balance_vectors">
<code class="descname">composition_balance_vectors</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.composition_balance_vectors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.composition_balance_vectors" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of lists with compositions and a list of composition keys.</p>
<p>The list of lists can be viewed as a matrix with rows corresponding to composition keys
(which are given as the second item in the returned tuple) and columns corresponding to
substances. Multiplying the matrix with a vector of concentrations give an equation which
is an invariant (corresponds to mass &amp; charge conservation).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">A: list of lists</p>
<p class="last">ck: (sorted) tuple of composition keys</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="s1">&#39;Cu+2 + NH3 -&gt; CuNH3+2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">re</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">substances</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39; \+ | -&gt; &#39;</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsys</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">s</span><span class="p">,</span> <span class="n">substances</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsys</span><span class="o">.</span><span class="n">composition_balance_vectors</span><span class="p">()</span>
<span class="go">([[2, 0, 2], [0, 3, 3], [0, 1, 1], [1, 0, 1]], [0, 1, 7, 29])</span>
</pre></div>
</div>
</dd></dl>

<dl class="classmethod">
<dt id="chempy.reactionsystem.ReactionSystem.from_string">
<em class="property">classmethod </em><code class="descname">from_string</code><span class="sig-paren">(</span><em>s</em>, <em>substances=None</em>, <em>rxn_parse_kwargs=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.from_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.from_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a reaction system from a string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>s</strong> : str</p>
<blockquote>
<div><p>Multiline string.</p>
</div></blockquote>
<p><strong>substances</strong> : convertible to iterable of str</p>
<p><strong>rxn_parse_kwargs</strong> : dict</p>
<blockquote>
<div><p>Keyword arguments passed on to the Reaction baseclass’ method <code class="docutils literal"><span class="pre">from_string</span></code>.</p>
</div></blockquote>
<p><strong>**kwargs:</strong></p>
<blockquote class="last">
<div><p>Keyword arguments passed to the constructor of the class</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="s1">&#39;2 HNO2 -&gt; H2O + NO + NO2; 3&#39;</span><span class="p">,</span> <span class="s1">&#39;2 NO2 -&gt; N2O4; 4&#39;</span><span class="p">]))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">r1</span><span class="p">,</span> <span class="n">r2</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="mi">5</span><span class="o">*</span><span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="o">*</span><span class="mi">7</span><span class="o">*</span><span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span><span class="o">.</span><span class="n">rates</span><span class="p">({</span><span class="s1">&#39;HNO2&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">:</span> <span class="mi">7</span><span class="p">})</span> <span class="o">==</span> <span class="p">{</span><span class="s1">&#39;HNO2&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">r1</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="n">r1</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">:</span> <span class="n">r1</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">:</span> <span class="n">r1</span> <span class="o">-</span> <span class="mi">2</span><span class="o">*</span><span class="n">r2</span><span class="p">,</span> <span class="s1">&#39;N2O4&#39;</span><span class="p">:</span> <span class="n">r2</span><span class="p">}</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.html">
<code class="descname">html</code><span class="sig-paren">(</span><em>with_param=True</em>, <em>checks=()</em>, <em>color_categories=True</em>, <em>split=True</em>, <em>print_fn=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.html"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.html" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a string with an HTML representation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>with_param</strong> : bool</p>
<p><strong>checks</strong> : tuple</p>
<p><strong>color_categories</strong> : bool</p>
<p><strong>split</strong> : bool</p>
<p><strong>print_fn</strong> : callable</p>
<blockquote class="last">
<div><p>default: <code class="xref py py-func docutils literal"><span class="pre">chempy.printing.html()</span></code></p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.identify_equilibria">
<code class="descname">identify_equilibria</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.identify_equilibria"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.identify_equilibria" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of index pairs of reactions forming equilibria.</p>
<p>The pairs are sorted with respect to index (lowest first)</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.net_stoichs">
<code class="descname">net_stoichs</code><span class="sig-paren">(</span><em>keys=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.net_stoichs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.net_stoichs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="chempy.reactionsystem.ReactionSystem.nr">
<code class="descname">nr</code><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.nr" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of reactions</p>
</dd></dl>

<dl class="attribute">
<dt id="chempy.reactionsystem.ReactionSystem.ns">
<code class="descname">ns</code><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.ns" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of substances</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.obeys_charge_neutrality">
<code class="descname">obeys_charge_neutrality</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.obeys_charge_neutrality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.obeys_charge_neutrality" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns False if any reaction violate charge neutrality.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.obeys_mass_balance">
<code class="descname">obeys_mass_balance</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.obeys_mass_balance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.obeys_mass_balance" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if all reactions obeys mass balance, else False.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.params">
<code class="descname">params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns list of per reaction <code class="docutils literal"><span class="pre">param</span></code> value</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.per_reaction_effect_on_substance">
<code class="descname">per_reaction_effect_on_substance</code><span class="sig-paren">(</span><em>substance_key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.per_reaction_effect_on_substance"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.per_reaction_effect_on_substance" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.per_substance_varied">
<code class="descname">per_substance_varied</code><span class="sig-paren">(</span><em>per_substance</em>, <em>varied=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.per_substance_varied"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.per_substance_varied" title="Permalink to this definition">¶</a></dt>
<dd><p>Dense nd-array for all combinations of varied levels per substance</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>per_substance: dict or array</strong></p>
<p><strong>varied: dict</strong></p>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><strong>ndarray</strong> : with len(varied) + 1 number of axes, and with last axis length == self.ns</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rsys</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="p">([],</span> <span class="s1">&#39;A B C&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="p">,</span> <span class="n">keys</span> <span class="o">=</span> <span class="n">rsys</span><span class="o">.</span><span class="n">per_substance_varied</span><span class="p">({</span><span class="s1">&#39;A&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;B&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">11</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">arr</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">keys</span>
<span class="go">((4, 3), (&#39;C&#39;,))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">(</span><span class="n">arr</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.rates">
<code class="descname">rates</code><span class="sig-paren">(</span><em>variables=None</em>, <em>backend=&lt;module 'math' (built-in)&gt;</em>, <em>substance_keys=None</em>, <em>ratexs=None</em>, <em>cstr_fr_fc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.rates"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.rates" title="Permalink to this definition">¶</a></dt>
<dd><p>Per substance sums of reaction rates rates.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>variables</strong> : dict</p>
<p><strong>backend</strong> : module, optional</p>
<p><strong>substance_keys</strong> : iterable of str, optional</p>
<p><strong>ratexs</strong> : iterable of RateExpr instances</p>
<p><strong>cstr_fr_fc</strong> : tuple (str, tuple of str)</p>
<blockquote>
<div><p>Continuously stirred tank reactor conditions. Pair of
flow/volume ratio key (feed-rate/tank-volume) and feed concentration
keys. (if second item is a string it is taken to be a prefix)</p>
</div></blockquote>
<p><strong>Returns</strong></p>
<p><strong>——-</strong></p>
<p><strong>dict</strong></p>
<blockquote class="last">
<div><p>per substance_key time derivatives of concentrations.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">r</span> <span class="o">=</span> <span class="n">Reaction</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="p">{</span><span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">},</span> <span class="mf">42.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rsys</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="p">([</span><span class="n">r</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rates</span> <span class="o">=</span> <span class="n">rsys</span><span class="o">.</span><span class="n">rates</span><span class="p">({</span><span class="s1">&#39;R&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;P&#39;</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">rates</span><span class="p">[</span><span class="s1">&#39;P&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">42</span><span class="o">*</span><span class="mi">3</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-14</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.sort_substances_inplace">
<code class="descname">sort_substances_inplace</code><span class="sig-paren">(</span><em>key=&lt;function &lt;lambda&gt;&gt;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.sort_substances_inplace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.sort_substances_inplace" title="Permalink to this definition">¶</a></dt>
<dd><p>Sorts the OrderedDict attribute <code class="docutils literal"><span class="pre">substances</span></code></p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.split">
<code class="descname">split</code><span class="sig-paren">(</span><em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.split"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.split" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits the reaction system into multiple disjoint reaction systems.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.stoichs">
<code class="descname">stoichs</code><span class="sig-paren">(</span><em>non_precip_rids=()</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.stoichs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.stoichs" title="Permalink to this definition">¶</a></dt>
<dd><p>Conditional stoichiometries depending on precipitation status</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.string">
<code class="descname">string</code><span class="sig-paren">(</span><em>with_param=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.string" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.substance_names">
<code class="descname">substance_names</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.substance_names"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.substance_names" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a tuple of the substances’ names</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.substance_participation">
<code class="descname">substance_participation</code><span class="sig-paren">(</span><em>substance_key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.substance_participation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.substance_participation" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns indices of reactions where substance_key occurs</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>substance_key: str</strong></td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">List of indices for self.rxns where <cite>substance_key</cite> participates</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;2 H2 + O2 -&gt; 2 H2O</span><span class="se">\n</span><span class="s1"> 2 H2O2 -&gt; 2 H2O + O2&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span><span class="o">.</span><span class="n">substance_participation</span><span class="p">(</span><span class="s1">&#39;H2&#39;</span><span class="p">)</span>
<span class="go">[0]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span><span class="o">.</span><span class="n">substance_participation</span><span class="p">(</span><span class="s1">&#39;O2&#39;</span><span class="p">)</span>
<span class="go">[0, 1]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span><span class="o">.</span><span class="n">substance_participation</span><span class="p">(</span><span class="s1">&#39;O3&#39;</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.unimolecular_html_table">
<code class="descname">unimolecular_html_table</code><span class="sig-paren">(</span><em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.unimolecular_html_table"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.unimolecular_html_table" title="Permalink to this definition">¶</a></dt>
<dd><p>unimolecular_html_table is deprecated since (not including) 0.5.7, it will be missing in 0.7.0. Use chempy.printing.tables.UnimolecularTable instead.</p>
</dd></dl>

<dl class="method">
<dt id="chempy.reactionsystem.ReactionSystem.upper_conc_bounds">
<code class="descname">upper_conc_bounds</code><span class="sig-paren">(</span><em>init_concs</em>, <em>min_=&lt;built-in function min&gt;</em>, <em>dtype=None</em>, <em>skip_keys=(0</em>, <em>)</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/reactionsystem.html#ReactionSystem.upper_conc_bounds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.reactionsystem.ReactionSystem.upper_conc_bounds" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates upper concentration bounds per substance based on substance composition.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>init_concs</strong> : dict or array_like</p>
<blockquote>
<div><p>Per substance initial conidtions.</p>
</div></blockquote>
<p><strong>min_</strong> : callbable</p>
<p><strong>dtype</strong> : dtype or None</p>
<p><strong>skip_keys</strong> : tuple</p>
<blockquote>
<div><p>What composition keys to skip.</p>
</div></blockquote>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">numpy.ndarray :</p>
<blockquote class="last">
<div><p>Per substance upper limit (ordered as <code class="xref py py-attr docutils literal"><span class="pre">substances</span></code>).</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>The function does not take into account wheter there actually exists a
reaction path leading to a substance. Note also that the upper limit is
per substance, i.e. the sum of all upper bounds amount to more substance than
available in <code class="docutils literal"><span class="pre">init_conc</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span> <span class="o">=</span> <span class="n">ReactionSystem</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="s1">&#39;2 HNO2 -&gt; H2O + NO + NO2 </span><span class="se">\n</span><span class="s1"> 2 NO2 -&gt; N2O4&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">collections</span> <span class="k">import</span> <span class="n">defaultdict</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c0</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">HNO2</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ref</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;HNO2&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;NO&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;NO2&#39;</span><span class="p">:</span> <span class="mi">20</span><span class="p">,</span> <span class="s1">&#39;N2O4&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rs</span><span class="o">.</span><span class="n">as_per_substance_dict</span><span class="p">(</span><span class="n">rs</span><span class="o">.</span><span class="n">upper_conc_bounds</span><span class="p">(</span><span class="n">c0</span><span class="p">))</span> <span class="o">==</span> <span class="n">ref</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-chempy.symbolic">
<span id="chempy-symbolic-module"></span><h2>chempy.symbolic module<a class="headerlink" href="#module-chempy.symbolic" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="chempy.symbolic.get_constant_symbols">
<code class="descclassname">chempy.symbolic.</code><code class="descname">get_constant_symbols</code><span class="sig-paren">(</span><em>Symbol=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/symbolic.html#get_constant_symbols"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.symbolic.get_constant_symbols" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-chempy.units">
<span id="chempy-units-module"></span><h2>chempy.units module<a class="headerlink" href="#module-chempy.units" title="Permalink to this headline">¶</a></h2>
<p>The units module provides the following attributes:</p>
<ul class="simple">
<li><code class="docutils literal"><span class="pre">chempy.units.default_units</span></code></li>
<li><code class="docutils literal"><span class="pre">chempy.units.default_constants</span></code></li>
<li><code class="docutils literal"><span class="pre">chempy.units.SI_base_registry</span></code></li>
</ul>
<p>together with some functions.</p>
<p>Currently <a class="reference external" href="https://pypi.python.org/pypi/quantities">quantities</a> is used as
the underlying package to handle units. If it is possible you should try to
only use the <code class="docutils literal"><span class="pre">chempy.units</span></code> module (since it is likely that <code class="docutils literal"><span class="pre">ChemPy</span></code>
will change this backend at some point in the future). Therefore you should not
rely on any attributes of the <code class="docutils literal"><span class="pre">Quantity</span></code> instances (and rather use
getter &amp; setter functions in <cite>chempy.units</cite>).</p>
<dl class="class">
<dt id="chempy.units.Backend">
<em class="property">class </em><code class="descclassname">chempy.units.</code><code class="descname">Backend</code><span class="sig-paren">(</span><em>underlying_backend=('numpy'</em>, <em>'math')</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#Backend"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.Backend" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Wrapper around modules such as numpy and math</p>
<p>Instances of Backend wraps a module, e.g. <cite>numpy</cite> and ensures that
arguments passed on are unitless, i.e. it raises an error if a
transcendental function is used with quantities with units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>underlying_backend</strong> : module, str or tuple of str</p>
<blockquote class="last">
<div><p>e.g. ‘numpy’ or (‘sympy’, ‘math’)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">km</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">default_units</span><span class="o">.</span><span class="n">kilometre</span><span class="p">,</span> <span class="n">default_units</span><span class="o">.</span><span class="n">metre</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">km</span><span class="p">)</span> <span class="o">==</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">be</span> <span class="o">=</span> <span class="n">Backend</span><span class="p">(</span><span class="s1">&#39;math&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">be</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">km</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">ValueError</span>: <span class="n">Unable to convert between units of &quot;km&quot; and &quot;dimensionless&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">([</span><span class="mi">1000</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">metre</span><span class="o">/</span><span class="n">pq</span><span class="o">.</span><span class="n">kilometre</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="go">1001.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">be_np</span> <span class="o">=</span> <span class="n">Backend</span><span class="p">(</span><span class="n">np</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">be_np</span><span class="o">.</span><span class="n">sum</span><span class="p">([[</span><span class="mi">1000</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">metre</span><span class="o">/</span><span class="n">pq</span><span class="o">.</span><span class="n">kilometre</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="go">array([ 2.,  7.])</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.allclose">
<code class="descclassname">chempy.units.</code><code class="descname">allclose</code><span class="sig-paren">(</span><em>a</em>, <em>b</em>, <em>rtol=1e-08</em>, <em>atol=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#allclose"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.allclose" title="Permalink to this definition">¶</a></dt>
<dd><p>Analogous to <code class="docutils literal"><span class="pre">numpy.allclose</span></code>.</p>
</dd></dl>

<dl class="function">
<dt id="chempy.units.compare_equality">
<code class="descclassname">chempy.units.</code><code class="descname">compare_equality</code><span class="sig-paren">(</span><em>a</em>, <em>b</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#compare_equality"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.compare_equality" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns True if two arguments are equal.</p>
<p>Both arguments need to have the same dimensionality.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>a</strong> : quantity</p>
<p class="last"><strong>b</strong> : quantity</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">km</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">default_units</span><span class="o">.</span><span class="n">kilometre</span><span class="p">,</span> <span class="n">default_units</span><span class="o">.</span><span class="n">metre</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_equality</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">km</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">False</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">compare_equality</span><span class="p">(</span><span class="mi">3</span><span class="o">*</span><span class="n">km</span><span class="p">,</span> <span class="mi">3000</span><span class="o">*</span><span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.concatenate">
<code class="descclassname">chempy.units.</code><code class="descname">concatenate</code><span class="sig-paren">(</span><em>arrays</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#concatenate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.concatenate" title="Permalink to this definition">¶</a></dt>
<dd><p>Patched version of numpy.concatenate</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">chempy.units</span> <span class="k">import</span> <span class="n">default_units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">all</span><span class="p">(</span><span class="n">concatenate</span><span class="p">(([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.default_unit_in_registry">
<code class="descclassname">chempy.units.</code><code class="descname">default_unit_in_registry</code><span class="sig-paren">(</span><em>value</em>, <em>registry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#default_unit_in_registry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.default_unit_in_registry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.format_string">
<code class="descclassname">chempy.units.</code><code class="descname">format_string</code><span class="sig-paren">(</span><em>value</em>, <em>precision='%.5g'</em>, <em>tex=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#format_string"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.format_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Formats a scalar with unit as two strings</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>value: float with unit</strong></p>
<p><strong>precision: str</strong></p>
<p><strong>tex: bool</strong></p>
<blockquote class="last">
<div><p>LaTeX formatted or not? (no ‘$’ signs)</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">format_string</span><span class="p">(</span><span class="mf">0.42</span><span class="o">*</span><span class="n">default_units</span><span class="o">.</span><span class="n">mol</span><span class="o">/</span><span class="n">default_units</span><span class="o">.</span><span class="n">decimetre</span><span class="o">**</span><span class="mi">3</span><span class="p">)))</span>
<span class="go">0.42 mol/decimetre**3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39; &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">format_string</span><span class="p">(</span><span class="mi">2</span><span class="o">/</span><span class="n">default_units</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">tex</span><span class="o">=</span><span class="kc">True</span><span class="p">)))</span>
<span class="go">2 \mathrm{\frac{1}{s}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.get_derived_unit">
<code class="descclassname">chempy.units.</code><code class="descname">get_derived_unit</code><span class="sig-paren">(</span><em>registry</em>, <em>key</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#get_derived_unit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.get_derived_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the unit of a physcial quantity in a provided unit system.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>registry: dict (str: unit)</strong></p>
<blockquote>
<div><p>mapping ‘length’, ‘mass’, ‘time’, ‘current’, ‘temperature’,
‘luminous_intensity’, ‘amount’. If registry is <code class="docutils literal"><span class="pre">None</span></code> the
function returns 1.0 unconditionally.</p>
</div></blockquote>
<p><strong>key: str</strong></p>
<blockquote class="last">
<div><p>one of the registry keys or one of: ‘diffusivity’, ‘electricalmobility’,
‘permittivity’, ‘charge’, ‘energy’, ‘concentration’, ‘density’,
‘radiolyticyield’.</p>
</div></blockquote>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">default_units</span><span class="o">.</span><span class="n">meter</span><span class="p">,</span> <span class="n">default_units</span><span class="o">.</span><span class="n">second</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_derived_unit</span><span class="p">(</span><span class="n">SI_base_registry</span><span class="p">,</span> <span class="s1">&#39;diffusivity&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">s</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.get_physical_quantity">
<code class="descclassname">chempy.units.</code><code class="descname">get_physical_quantity</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#get_physical_quantity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.get_physical_quantity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.html_of_unit">
<code class="descclassname">chempy.units.</code><code class="descname">html_of_unit</code><span class="sig-paren">(</span><em>quant</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#html_of_unit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.html_of_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns HTML reperesentation of the unit of a quantity</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">html_of_unit</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">default_units</span><span class="o">.</span><span class="n">m</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span>
<span class="go">m&lt;sup&gt;2&lt;/sup&gt;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.is_quantity">
<code class="descclassname">chempy.units.</code><code class="descname">is_quantity</code><span class="sig-paren">(</span><em>arg</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#is_quantity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.is_quantity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.is_unitless">
<code class="descclassname">chempy.units.</code><code class="descname">is_unitless</code><span class="sig-paren">(</span><em>expr</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#is_unitless"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.is_unitless" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <code class="docutils literal"><span class="pre">True</span></code> if <code class="docutils literal"><span class="pre">expr</span></code> is unitless, otherwise <code class="docutils literal"><span class="pre">False</span></code></p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">is_unitless</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">is_unitless</span><span class="p">(</span><span class="mi">42</span><span class="o">*</span><span class="n">default_units</span><span class="o">.</span><span class="n">kilogram</span><span class="p">)</span>
<span class="go">False</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.latex_of_unit">
<code class="descclassname">chempy.units.</code><code class="descname">latex_of_unit</code><span class="sig-paren">(</span><em>quant</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#latex_of_unit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.latex_of_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns LaTeX reperesentation of the unit of a quantity</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">latex_of_unit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">default_units</span><span class="o">.</span><span class="n">kelvin</span><span class="p">))</span>
<span class="go">\mathrm{\frac{1}{K}}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.linspace">
<code class="descclassname">chempy.units.</code><code class="descname">linspace</code><span class="sig-paren">(</span><em>start</em>, <em>stop</em>, <em>num=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#linspace"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.linspace" title="Permalink to this definition">¶</a></dt>
<dd><p>Analogous to <code class="docutils literal"><span class="pre">numpy.linspace</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">linspace</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-15</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.logspace_from_lin">
<code class="descclassname">chempy.units.</code><code class="descname">logspace_from_lin</code><span class="sig-paren">(</span><em>start</em>, <em>stop</em>, <em>num=50</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#logspace_from_lin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.logspace_from_lin" title="Permalink to this definition">¶</a></dt>
<dd><p>Logarithmically spaced data points</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="n">logspace_from_lin</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">3</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mi">4</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1e-15</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.magnitude">
<code class="descclassname">chempy.units.</code><code class="descname">magnitude</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.magnitude" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.polyfit">
<code class="descclassname">chempy.units.</code><code class="descname">polyfit</code><span class="sig-paren">(</span><em>x</em>, <em>y</em>, <em>deg</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#polyfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.polyfit" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.polyval">
<code class="descclassname">chempy.units.</code><code class="descname">polyval</code><span class="sig-paren">(</span><em>p</em>, <em>x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#polyval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.polyval" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.rescale">
<code class="descclassname">chempy.units.</code><code class="descname">rescale</code><span class="sig-paren">(</span><em>value</em>, <em>unit</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#rescale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.rescale" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.simplified">
<code class="descclassname">chempy.units.</code><code class="descname">simplified</code><span class="sig-paren">(</span><em>value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#simplified"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.simplified" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="chempy.units.tile">
<code class="descclassname">chempy.units.</code><code class="descname">tile</code><span class="sig-paren">(</span><em>array</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#tile"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.tile" title="Permalink to this definition">¶</a></dt>
<dd><p>Parched version of numpy.tile</p>
</dd></dl>

<dl class="function">
<dt id="chempy.units.to_unitless">
<code class="descclassname">chempy.units.</code><code class="descname">to_unitless</code><span class="sig-paren">(</span><em>value</em>, <em>new_unit=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#to_unitless"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.to_unitless" title="Permalink to this definition">¶</a></dt>
<dd><p>Nondimensionalization of a quantity.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><p class="first"><strong>value: quantity</strong></p>
<p class="last"><strong>new_unit: unit</strong></p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;</span><span class="si">%.1g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="n">to_unitless</span><span class="p">(</span><span class="mi">1</span><span class="o">*</span><span class="n">default_units</span><span class="o">.</span><span class="n">metre</span><span class="p">,</span> <span class="n">default_units</span><span class="o">.</span><span class="n">nm</span><span class="p">)</span>
<span class="go">&#39;1e+09&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;</span><span class="si">%.1g</span><span class="s1"> </span><span class="si">%.1g</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">to_unitless</span><span class="p">([</span><span class="mi">1</span><span class="o">*</span><span class="n">default_units</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span><span class="o">*</span><span class="n">default_units</span><span class="o">.</span><span class="n">mm</span><span class="p">],</span> <span class="n">default_units</span><span class="o">.</span><span class="n">nm</span><span class="p">))</span>
<span class="go">&#39;1e+09 1e+06&#39;</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.unicode_of_unit">
<code class="descclassname">chempy.units.</code><code class="descname">unicode_of_unit</code><span class="sig-paren">(</span><em>quant</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#unicode_of_unit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.unicode_of_unit" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns unicode reperesentation of the unit of a quantity</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">unicode_of_unit</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">default_units</span><span class="o">.</span><span class="n">kelvin</span><span class="p">))</span>
<span class="go">1/K</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.uniform">
<code class="descclassname">chempy.units.</code><code class="descname">uniform</code><span class="sig-paren">(</span><em>container</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#uniform"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.uniform" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns a list, tuple or dict with mixed units into one with uniform units.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>container</strong> : tuple, list or dict</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">km</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="n">default_units</span><span class="o">.</span><span class="n">kilometre</span><span class="p">,</span> <span class="n">default_units</span><span class="o">.</span><span class="n">metre</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uniform</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">3</span><span class="o">*</span><span class="n">km</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">200</span><span class="o">*</span><span class="n">m</span><span class="p">))</span>  
<span class="go">{&#39;b&#39;: array(200.0) * m, &#39;a&#39;: array(3000.0) * m}</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.unit_of">
<code class="descclassname">chempy.units.</code><code class="descname">unit_of</code><span class="sig-paren">(</span><em>expr</em>, <em>simplified=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#unit_of"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.unit_of" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the unit of a quantity</p>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">unit_of</span><span class="p">(</span><span class="mi">42</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">second</span><span class="p">)</span> <span class="o">==</span> <span class="n">unit_of</span><span class="p">(</span><span class="mi">12</span><span class="o">*</span><span class="n">pq</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">unit_of</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="go">1</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="chempy.units.unit_registry_from_human_readable">
<code class="descclassname">chempy.units.</code><code class="descname">unit_registry_from_human_readable</code><span class="sig-paren">(</span><em>unit_registry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#unit_registry_from_human_readable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.unit_registry_from_human_readable" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialization of unit_registry.</p>
</dd></dl>

<dl class="function">
<dt id="chempy.units.unit_registry_to_human_readable">
<code class="descclassname">chempy.units.</code><code class="descname">unit_registry_to_human_readable</code><span class="sig-paren">(</span><em>unit_registry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#unit_registry_to_human_readable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.unit_registry_to_human_readable" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialization of a unit registry.</p>
</dd></dl>

<dl class="function">
<dt id="chempy.units.unitless_in_registry">
<code class="descclassname">chempy.units.</code><code class="descname">unitless_in_registry</code><span class="sig-paren">(</span><em>value</em>, <em>registry</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/chempy/units.html#unitless_in_registry"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#chempy.units.unitless_in_registry" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="chempy.electrochemistry.html" class="btn btn-neutral float-right" title="chempy.electrochemistry package" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Welcome to chempy’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Bjoern I. Dahlgren &lt;bjodah@gmail.com&gt;.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.6.4',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>