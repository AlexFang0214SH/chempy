machine:
  environment:
    PATH: "$HOME/miniconda/bin:${PATH}"

dependencies:
  pre:
    - ./scripts/circleci_dependencies.sh
  cache_directories:
    - "~/miniconda"

test:
  override:
    - sudo apt-get remove gcc
    - cd && rm -rf ~/.pyenv && rm -rf ~/virtualenvs
    - source $HOME/miniconda/bin/activate root
    - conda config --remove channels defaults
    - conda config --add channels defaults
    - conda config --add channels conda-forge
    - conda config --set show_channel_urls true
    - conda install pip pytest numpy scipy matplotlib sympy quantities pyparsing
    - pip install .
    - pytest
